"use strict";(self.webpackChunkpitfall_js=self.webpackChunkpitfall_js||[]).push([[524],{157:(e,t,n)=>{n.r(t),n.d(t,{init:()=>Vn});const i=5,s=new AudioContext;s.onstatechange=()=>{"suspended"===s.state&&g()};let r=!0;document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?(r=!0,"suspended"===s.state&&s.resume()):"hidden"===document.visibilityState&&(r=!1,g(),"running"===s.state&&s.suspend())}));const o=s.createGain();o.connect(s.destination),o.gain.value=.1;const a=[],l=new Map,c=new Map;function h(e){"suspended"!==s.state?o.gain.value=e/100:r&&s.resume().then((()=>h(e)))}function d(e,t=!1){if("suspended"===s.state)return void(r&&s.resume().then((()=>d(e))));if(t){if(c.has(e))return}else u(e);const n=s.createBufferSource();n.buffer=l.get(e),n.connect(o),n.loop=t,c.set(e,n),n.onended=()=>c.delete(e),n.start()}function u(e){const t=c.get(e);t&&(c.delete(e),t.stop())}function g(){for(const e of c.values())e.stop();c.clear()}const f=new Array(255);var p,O,A,m;!function(e){e[e.TAR=0]="TAR",e[e.QUICKSAND=1]="QUICKSAND",e[e.CROCS=2]="CROCS",e[e.SHIFTING_TAR=3]="SHIFTING_TAR",e[e.SHIFTING_QUICKSAND=4]="SHIFTING_QUICKSAND",e[e.NONE=5]="NONE"}(p||(p={})),function(e){e[e.MONEY_BAG=0]="MONEY_BAG",e[e.SILVER_BRICK=1]="SILVER_BRICK",e[e.GOLD_BRICK=2]="GOLD_BRICK",e[e.DIAMOND_RING=3]="DIAMOND_RING",e[e.NONE=4]="NONE"}(O||(O={})),function(e){e[e.ONE_ROLLING_LOG=0]="ONE_ROLLING_LOG",e[e.TWO_ROLLING_LOGS_NEAR=1]="TWO_ROLLING_LOGS_NEAR",e[e.TWO_ROLLING_LOGS_FAR=2]="TWO_ROLLING_LOGS_FAR",e[e.THREE_ROLLING_LOGS=3]="THREE_ROLLING_LOGS",e[e.ONE_STATIONARY_LOG=4]="ONE_STATIONARY_LOG",e[e.THREE_STATIONARY_LOGS=5]="THREE_STATIONARY_LOGS",e[e.FIRE=6]="FIRE",e[e.COBRA=7]="COBRA",e[e.NONE=8]="NONE"}(A||(A={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.NONE=2]="NONE"}(m||(m={}));class E{trees;ladder;holes;vine;pit;treasure;obsticles;wall;scorpion;difficulty;constructor(e,t,n,i,s,r,o,a,l,c){this.trees=e,this.ladder=t,this.holes=n,this.vine=i,this.pit=s,this.treasure=r,this.obsticles=o,this.wall=a,this.scorpion=l,this.difficulty=c}}let L=196;for(let e=0;e<f.length;++e){let t=304;const n=L>>6;let i=!1,s=!1,r=!1,o=p.NONE,a=O.NONE,l=A.NONE,c=m.NONE;switch(L>>3&7){case 0:i=!0,t+=5;break;case 1:i=!0,s=!0,t+=10;break;case 2:r=!0,o=p.TAR,t+=143;break;case 3:r=!0,o=p.QUICKSAND,t+=143;break;case 4:r=1==(L>>1&1),o=p.CROCS,t+=r?143:240;break;case 5:o=p.SHIFTING_TAR,a=3&L,t+=111;break;case 6:o=p.SHIFTING_TAR,r=!0,t+=111;break;case 7:o=p.SHIFTING_QUICKSAND,t+=111}if(a===O.NONE&&o!==p.CROCS)switch(l=7&L,l){case A.ONE_STATIONARY_LOG:case A.THREE_STATIONARY_LOGS:case A.ONE_ROLLING_LOG:t+=5;break;case A.TWO_ROLLING_LOGS_FAR:t+=10;break;case A.TWO_ROLLING_LOGS_NEAR:t+=15;break;case A.THREE_ROLLING_LOGS:t+=20;break;case A.FIRE:case A.COBRA:t+=30}i&&(c=L>>7&1),f[e]=new E(n,i,s,r,o,a,l,c,!i,t),L=255&(L<<1|L>>7&1^L>>5&1^L>>4&1^L>>3&1)}const w="pitfall-store";var R;!function(e){e[e.EASY=0]="EASY",e[e.NORMAL=1]="NORMAL",e[e.HARD=2]="HARD"}(R||(R={}));class y{highScores=[0,0,0];volume=10;difficulty=0;gameState=void 0}let I;function S(){I.gameState?.gameOver&&(I.gameState=void 0),localStorage.setItem(w,JSON.stringify(I))}const C=2*Math.PI;class N{x;y;vy;constructor(e,t,n){this.x=e,this.y=t,this.vy=n}}class v{r;g;b;constructor(e,t,n){this.r=e,this.g=t,this.b=n}}var x,G,D;!function(e){e[e.WIDTH=136]="WIDTH",e[e.HEIGHT=180]="HEIGHT"}(x||(x={})),function(e){e[e.WIDTH=3.4]="WIDTH",e[e.HEIGHT=2.3684210526315788]="HEIGHT"}(G||(G={})),function(e){e[e.BROWN=18]="BROWN",e[e.YELLOW=30]="YELLOW",e[e.ORANGE=62]="ORANGE",e[e.RED=72]="RED",e[e.OFF_GREEN=213]="OFF_GREEN",e[e.GREEN=214]="GREEN",e[e.BLUE=164]="BLUE",e[e.YELLOW_GREEN=200]="YELLOW_GREEN",e[e.PINK=74]="PINK",e[e.BLACK=0]="BLACK",e[e.OFF_BLACK=2]="OFF_BLACK",e[e.GREY=6]="GREY",e[e.OFF_WHITE=12]="OFF_WHITE",e[e.WHITE=14]="WHITE",e[e.DARK_GREEN=210]="DARK_GREEN",e[e.DARK_RED=66]="DARK_RED",e[e.DARK_YELLOW=20]="DARK_YELLOW",e[e.MID_YELLOW=22]="MID_YELLOW",e[e.LIGHT_YELLOW=24]="LIGHT_YELLOW",e[e.DARK_BROWN=16]="DARK_BROWN"}(D||(D={}));const b=new Array(256),T=new Array(2),B=new Array(2),k=new Array(2),H=new Array(2),_=new Array(2),M=new Array(2),F=new Array(2),W=new Array(2),Y=new Array(2),P=new Array(2),K=new Array(2),U=new Array(2),X=new Array(2),Q=new Array(2),V=new Array(2),j=new Array(2);let Z,J,z,$,q,ee;const te=new Array(256),ne=new Array(3),ie=285,se=64,re=28,oe=new Array(ie),ae=new Array(ie),le=new Array(ie),ce=new Array(2);async function he(e,t,n){return new Promise((i=>{const s=new ImageData(e,t);n(s),createImageBitmap(s).then((e=>i({imageBitmap:e,imageData:s})))}))}function de(e){const t=new Array(e.height),{data:n}=e;for(let i=0,s=3;i<e.height;++i){t[i]=new Array(e.width);for(let r=0;r<e.width;++r,s+=4)t[i][r]=0!==n[s]}return t}function ue(e,t,n,i,s,r,o,a,l){l.push(he(8,s,(o=>{if(r)for(let r=0;r<s;++r){const a=s-1-r,l=e.charCodeAt(n+a),c=t[e.charCodeAt(i+a)];for(let e=0,t=1;e<8;++e,t<<=1)l&t&&ge(o,e,r,c)}else for(let r=0;r<s;++r){const a=s-1-r,l=e.charCodeAt(n+a),c=t[e.charCodeAt(i+a)];for(let e=0,t=128;e<8;++e,t>>=1)l&t&&ge(o,e,r,c)}})).then((({imageBitmap:e,imageData:t})=>{o(e),a&&a(de(t))})))}function ge(e,t,n,i){const s=4*(n*e.width+t),r=e.data;r[s]=i.r,r[s+1]=i.g,r[s+2]=i.b,r[s+3]=255}function fe(e,t,n,i,s,r){const o=Math.abs(i-t),a=t<i?1:-1,l=-Math.abs(s-n),c=n<s?1:-1;let h=o+l;for(;ge(e,t,n,r),t!==i||n!==s;){const e=2*h;e>=l&&(h+=l,t+=a),e<=o&&(h+=o,n+=c)}}function pe(e,t,n,i,s,r=1){const o=te[s];for(;t>0||r>0;)e.drawImage(o[t%10],n,i),t=Math.floor(t/10),--r,n-=8}const Oe=.5;let Ae=!1,me=!1,Ee=!1,Le=!1,we=!1,Re=!1,ye=!1,Ie=!1,Se=!1,Ce=!1,Ne=!1,ve=!1,xe=!1,Ge=!1,De=!1,be=!1,Te=!1,Be=!1,ke=!1,He=!1,_e=0,Me=0,Fe=0,We=0,Ye=!1,Pe=0,Ke=0,Ue=null,Xe=!1;class Qe{timestampDown=0;xDown=0;yDown=0;x=0;y=0}const Ve=new Map;function je(){_e=0,Me=0,Fe=0,We=0,Ye=!1,Pe=0,Ke=0,Ve.clear()}function Ze(){null!==Ue&&(clearTimeout(Ue),Ue=null),Xe&&(document.body.style.cursor="default",Xe=!1)}function Je(){Ze(),Ue=window.setTimeout((()=>{document.body.style.cursor="none",Xe=!0}),3e3)}function ze(e){e.preventDefault();const t=window.innerWidth,n=window.innerHeight,i=t>=n;for(let t=e.changedTouches.length-1;t>=0;--t){const s=e.changedTouches[t];let r,o;switch(i?(r=s.clientX,o=s.clientY):(r=n-1-s.clientY,o=s.clientX),e.type){case"touchstart":{const e=new Qe;e.timestampDown=Date.now(),e.xDown=e.x=r,e.yDown=e.y=o,Ve.set(s.identifier,e);break}case"touchmove":{Je();const e=Ve.get(s.identifier);e&&(e.x=r,e.y=o);break}case"touchend":case"touchcancel":{const e=Ve.get(s.identifier);e&&(r<64&&o<64&&e.xDown<64&&e.yDown<64&&wn(),Ve.delete(s.identifier));break}}}const s=t/2;Pe=Ke=0;for(const[t,n]of Array.from(Ve)){n.x<s?(n.x>=64||n.y>=64)&&(Pe=n.timestampDown):Ke=n.timestampDown;e:{for(let n=e.touches.length-1;n>=0;--n)if(e.touches[n].identifier===t)break e;Ve.delete(t)}}}function $e(e){if(!e.clientX||!e.clientY)return;const t=window.innerWidth,n=window.innerHeight;let i,s;t>=n?(i=e.clientX,s=e.clientY):(i=n-1-e.clientY,s=e.clientX),i<64&&s<64&&wn()}function qe(e){switch(e.code){case"KeyA":case"ArrowLeft":_e=Me+1;break;case"KeyD":case"ArrowRight":Me=_e+1;break;case"KeyW":case"ArrowUp":Fe=We+1;break;case"KeyS":case"ArrowDown":We=Fe+1;break;case"Escape":wn();break;default:Ye=!0}}function et(e){switch(e.code){case"KeyA":case"ArrowLeft":_e=0;break;case"KeyD":case"ArrowRight":Me=0;break;case"KeyW":case"ArrowUp":Fe=0;break;case"KeyS":case"ArrowDown":We=0;break;case"Escape":break;default:Ye=!1}}const tt=119,nt=174,it=22/289,st=17*-it;var rt;!function(e){e[e.STANDING=0]="STANDING",e[e.FALLING=1]="FALLING",e[e.CLIMBING=2]="CLIMBING",e[e.INJURED=3]="INJURED",e[e.SWINGING=4]="SWINGING",e[e.SINKING=5]="SINKING",e[e.KNEELING=6]="KNEELING",e[e.SKIDDING=7]="SKIDDING"}(rt||(rt={}));class ot{mainState;lastMainState;scene;absoluteX;x;y;vy;dir;sprite;runCounter;climbCounter;teleported;injuredCounter;tunnelSpawning;releasedVine;swallow;kneeling;kneelingDelay;rightTouchMeansDown;rollingDelay;constructor(e={mainState:rt.STANDING,lastMainState:rt.STANDING,scene:0,absoluteX:4,x:4,y:tt,vy:0,dir:0,sprite:0,runCounter:0,climbCounter:0,teleported:!1,injuredCounter:0,tunnelSpawning:!1,releasedVine:!1,swallow:!1,kneeling:!1,kneelingDelay:!1,rightTouchMeansDown:!1,rollingDelay:0}){this.mainState=e.mainState,this.lastMainState=e.lastMainState,this.scene=e.scene,this.absoluteX=e.absoluteX,this.x=e.x,this.y=e.y,this.vy=e.vy,this.dir=e.dir,this.sprite=e.sprite,this.runCounter=e.runCounter,this.climbCounter=e.climbCounter,this.teleported=e.teleported,this.injuredCounter=e.injuredCounter,this.tunnelSpawning=e.tunnelSpawning,this.releasedVine=e.releasedVine,this.swallow=e.swallow,this.kneeling=e.kneeling,this.kneelingDelay=e.kneelingDelay,this.rightTouchMeansDown=e.rightTouchMeansDown,this.rollingDelay=e.rollingDelay}intersects(e,t,n){return function(e,t,n,i,s,r){t=Math.floor(t),n=Math.floor(n);const o=e[0].length-1,a=e.length-1;s=Math.floor(s)-t,r=Math.floor(r)-n;const l=s+i[0].length-1,c=r+i.length-1;if(c<0||a<r||l<0||o<s)return!1;const h=Math.max(0,s),d=Math.min(o,l),u=Math.max(0,r),g=Math.min(a,c);for(let t=u;t<=g;++t)for(let n=h;n<=d;++n)if(e[t][n]&&i[t-r][n-s])return!0;return!1}(e,t,n,B[this.dir][this.sprite],Math.floor(this.x)-4,Math.floor(this.y)-22)}canBeHitByRollingLog(){return this.mainState===rt.STANDING||this.mainState===rt.KNEELING||this.mainState===rt.CLIMBING}isClimbing(){return this.mainState===rt.CLIMBING}isFalling(){return this.mainState===rt.FALLING}isUnderground(){switch(this.mainState){case rt.SINKING:case rt.SWINGING:case rt.SKIDDING:case rt.KNEELING:return!1}return this.y>146}teleport(e){this.teleported=!0,this.setX(e)}setX(e){this.incrementX(e-this.x)}incrementX(e){this.absoluteX+=e,this.x+=e,this.x<0?(this.x+=x.WIDTH,this.y>tt?this.scene-=3:--this.scene,this.scene<0&&(this.scene+=f.length)):this.x>=x.WIDTH&&(this.x-=x.WIDTH,this.y>tt?this.scene+=3:++this.scene,this.scene>=f.length&&(this.scene-=f.length))}startFalling(e,t){this.mainState=rt.FALLING,this.y+=t,this.vy=it+t,this.sprite=2,this.kneeling=!1,this.updateShift(e)}endFalling(e,t){this.mainState=rt.STANDING,this.y=t,this.vy=0,this.sprite=2,this.runCounter=0,this.tunnelSpawning=!1,this.releasedVine=!1,this.updateShift(e)}startClimbing(e){this.mainState=rt.CLIMBING,this.teleport(64),this.y=e,this.sprite=7,this.kneeling=!1,this.climbCounter=0,this.rightTouchMeansDown=134===e!=(0!==this.dir)}endClimbing(e,t,n){this.mainState=rt.STANDING,this.teleport(e),this.y=t,this.runCounter=0,this.sprite=0,this.dir=n}updateShift(e){const{wall:t}=f[this.scene];let n=!1;if(me){let e=!0;this.y>=120&&(t===m.RIGHT&&119===this.x||t===m.LEFT&&1===this.x)?e=!1:this.y>tt&&this.y<=157&&(this.x>=32&&this.x<=44?this.x>43.5&&(e=!1):this.x>=84&&this.x<=96&&this.x>95.5&&(e=!1)),e&&(this.incrementX(.5),this.dir=0,n=!0)}else if(Ae){let e=!0;this.y>=120&&(t===m.LEFT&&10===this.x||t===m.RIGHT&&128===this.x)?e=!1:this.y>tt&&this.y<=157&&(this.x>=32&&this.x<=43?this.x<32.5&&(e=!1):this.x>=84&&this.x<=95&&this.x<84.5&&(e=!1)),e&&(this.incrementX(-.5),this.dir=1,n=!0)}return n}canStartClimbingUp(){return this.mainState==rt.STANDING&&this.y===nt&&this.x>=56&&this.x<=72&&!(Ae||me||Ee||Le||we)}updateStanding(e){const{ladder:t,holes:n}=f[this.scene];if(n&&this.y===tt&&(this.x>=32&&this.x<=44||this.x>=84&&this.x<=96))return this.startFalling(e,it),e.score=Math.max(0,e.score-100),void d("sfx/fall.mp3");if(we)return this.startFalling(e,st),void d("sfx/jump.mp3");if(t){if(this.y===tt&&(this.x>=60&&this.x<=67||(Le&&!Ae&&!me||Se)&&this.x>=56&&this.x<=72))return void this.startClimbing(134);if(this.y===nt&&(Ee&&!Ae&&!me||Ie)&&this.x>=56&&this.x<=72)return void this.startClimbing(this.y)}this.updateShift(e)?(0===this.runCounter&&6==++this.sprite&&(this.sprite=1),this.runCounter=this.runCounter+1&3):(this.runCounter=0,this.sprite=this.lastMainState===rt.FALLING?2:0)}updateFalling(e){const{ladder:t,holes:n,wall:i}=f[this.scene];if(t&&this.y>=134&&this.y<nt&&this.x>=60&&this.x<=67){const e=Math.floor((this.y-134)/4);return this.startClimbing(134+4*e),void(this.dir^=1&e)}const s=this.y+this.vy;if(this.y<=tt&&s>=tt){if(t&&this.x>=60&&this.x<=67)return void this.startClimbing(134);if(!n||this.x<32||this.x>95||this.x>43&&this.x<84)return void this.endFalling(e,tt)}this.y<=nt&&s>=nt?this.endFalling(e,nt):(this.y+=this.vy,this.vy+=it,this.sprite=5,this.updateShift(e))}climbUpward(){134===this.y?this.climbCounter=0:++this.climbCounter>=8&&(this.climbCounter=0,this.y-=4,this.dir^=1)}climbDownward(){return this.y===nt?(this.endClimbing(this.x,nt,this.dir),!0):(++this.climbCounter>=8&&(this.climbCounter=0,this.y+=4,this.dir^=1),!1)}updateClimbing(e){if(this.y<=142){if(134===this.y&&Ee)return void(this.rightTouchMeansDown?this.endClimbing(59,tt,1):this.endClimbing(69,tt,0));if(ye||Ce&&0===this.dir)return void this.endClimbing(69,tt,0);if(Re||Ce&&1===this.dir)return void this.endClimbing(59,tt,1)}if(this.y>=170&&!Ee&&(Ae||me))this.endClimbing(this.x,nt,this.dir);else if(Ee)this.climbUpward();else if(Le&&this.climbDownward())return}isInjured(){return this.mainState===rt.INJURED||this.mainState===rt.SINKING}injure(){this.mainState=rt.INJURED,this.injuredCounter=20,d("sfx/die.mp3")}startTunnelSpawn(e){if(0===e.extraLives)return void e.endGame();let t;--e.extraLives,this.mainState=rt.FALLING,this.tunnelSpawning=!0,0===this.dir?(t=this.x-38,t<4&&(t=this.x+38)):(t=this.x+38,t>=140&&(t=this.x-38)),this.teleport(t),this.y=149,this.vy=0,this.sprite=2}startTreeSpawn(e){0!==e.extraLives?(--e.extraLives,this.mainState=rt.FALLING,this.teleport(0===this.dir?8:127),this.y=51,this.vy=0,this.sprite=2,this.swallow=!1):e.endGame()}updateInjured(e){0!=--this.injuredCounter||(this.isUnderground()?this.startTunnelSpawn(e):this.startTreeSpawn(e))}swing(){this.mainState=rt.SWINGING,this.sprite=6,this.teleported=!0,d("sfx/swing.mp3")}updateSwinging(e){const t=oe[e.vine.sprite];if(this.setX(0===this.dir?t.x+1:t.x),this.y=t.y+17,0===this.dir&&ye||1===this.dir&&Re)return this.startFalling(e,t.vy),void(this.releasedVine=!0)}checkSink(e,t){const n=Math.floor(this.x);return!(this.mainState!==rt.STANDING||this.y!==tt||n<e||n>t||(this.mainState=rt.SINKING,this.sprite=0,d("sfx/die.mp3"),0))}checkSwallow(e,t){const n=Math.floor(this.x);n<e||n>t||(this.swallow=!0)}updateSinking(e){++this.y>163&&this.startTreeSpawn(e)}startKnelling(){this.mainState=rt.KNEELING,this.sprite=5,this.kneeling=!0,this.kneelingDelay=!0}rolled(){switch(d("sfx/kneel.mp3",!0),this.rollingDelay=2,this.mainState){case rt.STANDING:case rt.KNEELING:this.startKnelling();break;case rt.CLIMBING:this.climbDownward()}}skidded(){switch(d("sfx/kneel.mp3",!0),this.mainState){case rt.STANDING:case rt.SKIDDING:this.mainState=rt.SKIDDING,this.sprite=5,this.kneeling=!0,this.kneelingDelay=!0}}updateKneeling(e){this.kneelingDelay?this.kneelingDelay=!1:(this.mainState=rt.STANDING,this.sprite=0,this.kneeling=!1,u("sfx/kneel.mp3"))}updateSkidding(e){this.updateKneeling(e),this.updateStanding(e)}update(e){const t=this.mainState;switch(this.mainState){case rt.STANDING:this.updateStanding(e);break;case rt.FALLING:this.updateFalling(e);break;case rt.CLIMBING:this.updateClimbing(e);break;case rt.INJURED:this.updateInjured(e);break;case rt.SWINGING:this.updateSwinging(e);break;case rt.SINKING:this.updateSinking(e);break;case rt.KNEELING:this.updateKneeling(e);break;case rt.SKIDDING:this.updateSkidding(e)}this.lastMainState=t,this.rollingDelay>0&&0==--this.rollingDelay&&u("sfx/kneel.mp3")}render(e,t,n){const i=T[this.dir][this.kneeling?5:this.sprite],s=Math.floor(this.x)-4-n,r=this.kneeling?102:Math.floor(this.y)-22;if(this.mainState===rt.SINKING)if(this.swallow){if(r<121){t.drawImage(i,0,0,8,121-r,s,r,8,121-r);const o=_[e.sceneStates[this.scene].enteredLeft?0:1];t.drawImage(o[0],0,9,8,2,44-n,120,8,2),t.drawImage(o[0],0,9,8,2,60-n,120,8,2),t.drawImage(o[0],0,9,8,2,76-n,120,8,2)}}else r<119&&t.drawImage(i,0,0,8,119-r,s,r,8,119-r);else this.tunnelSpawning&&r>=127&&r<142?t.drawImage(i,0,142-r,8,r-100,s,142,8,r-100):r<101||r>=127?t.drawImage(i,s,r):(r<122&&t.drawImage(i,0,0,8,122-r,s,r,8,122-r),r>106&&t.drawImage(i,0,127-r,8,r-105,s,127,8,r-105))}}const at=x.WIDTH/2,lt=x.WIDTH-4,ct=x.WIDTH/8;class ht{x;X;dir;sprite;updateCounter;constructor(e={x:at,X:at,dir:0,sprite:0,updateCounter:8}){this.x=e.x,this.X=e.X,this.dir=e.dir,this.sprite=e.sprite,this.updateCounter=e.updateCounter}update(e){const t=f[e.harry.scene].scorpion&&e.harry.isUnderground();if(t&&e.harry.intersects(F[this.dir][this.sprite],Math.floor(this.x)-4,158))e.harry.injure();else if(!(--this.updateCounter>0)){if(this.updateCounter=8,this.sprite^=1,t&&Math.abs(e.harry.x-this.x)>=ct){const t=this.dir;if(this.dir=this.x>e.harry.x?1:0,t!==this.dir)return}0===this.dir?this.x>=lt?this.dir=1:++this.x:this.x<=4?this.dir=0:--this.x}}render(e,t,n){t.drawImage(M[this.dir][this.sprite],Math.floor(this.x)-4-n,158)}}class dt{sprite;constructor(e={sprite:Math.floor(oe.length/2)}){this.sprite=e.sprite}update(e){++this.sprite===oe.length&&(this.sprite=0);const{harry:t}=e;f[t.scene].vine&&!t.releasedVine&&t.isFalling()&&t.intersects(le[this.sprite],33,28)&&t.swing()}render(e,t,n){t.drawImage(ae[this.sprite],33-n,28)}}const ut=[[33,95],[37,91],[41,87],[49,79],[61,67]],gt=[[33,43],[53,59],[69,75],[85,95]],ft=[[33,48],[53,64],[69,80],[85,95]],pt=[[33,43],[48,59],[64,75],[80,95]],Ot=[[45,51],[61,67],[77,83]];var At,mt,Et,Lt;!function(e){e[e.OPENED=0]="OPENED",e[e.CLOSING=1]="CLOSING",e[e.CLOSED=2]="CLOSED",e[e.OPENING=3]="OPENING"}(At||(At={})),function(e){e[e.OPENED=0]="OPENED",e[e.CLOSED=1]="CLOSED"}(mt||(mt={}));class wt{pitState;pitOffset;pitCounter;crocState;crocCounter;constructor(e={pitState:At.OPENED,pitOffset:0,pitCounter:71,crocState:mt.CLOSED,crocCounter:192}){this.pitState=e.pitState,this.pitOffset=e.pitOffset,this.pitCounter=e.pitCounter,this.crocState=e.crocState,this.crocCounter=e.crocCounter}updatePitOpened(e){--this.pitCounter>=0||(this.pitState=At.CLOSING,this.pitCounter=4,++this.pitOffset)}updatePitClosing(e){if(!(--this.pitCounter>=0))return 5==++this.pitOffset?(this.pitState=At.CLOSED,void(this.pitCounter=143)):void(this.pitCounter=4)}updatePitClosed(e){--this.pitCounter>=0||(this.pitState=At.OPENING,this.pitCounter=4,--this.pitOffset)}updatePitOpening(e){if(!(--this.pitCounter>=0))return 0==--this.pitOffset?(this.pitState=At.OPENED,void(this.pitCounter=71)):void(this.pitCounter=4)}updateCrocOpened(e){if(0==--this.crocCounter)return this.crocState=mt.CLOSED,this.crocCounter=193,void this.updateCrocClosed(e);const{harry:t,sceneStates:n}=e;if(f[t.scene].pit!==p.CROCS)return;const i=n[t.scene].enteredLeft?ft:pt;for(let e=i.length-1;e>=0;--e){const n=i[e];if(t.checkSink(n[0],n[1])){for(let e=Ot.length-1;e>=0;--e){const n=Ot[e];t.checkSwallow(n[0],n[1])}break}}}updateCrocClosed(e){if(0==--this.crocCounter)return this.crocState=mt.OPENED,this.crocCounter=129,void this.updateCrocOpened(e);const{harry:t}=e;if(f[t.scene].pit===p.CROCS)for(let e=gt.length-1;e>=0;--e){const n=gt[e];if(t.checkSink(n[0],n[1]))break}}update(e){switch(this.pitState){case At.OPENED:this.updatePitOpened(e);break;case At.CLOSING:this.updatePitClosing(e);break;case At.CLOSED:this.updatePitClosed(e);break;case At.OPENING:this.updatePitOpening(e)}switch(this.crocState){case mt.OPENED:this.updateCrocOpened(e);break;case mt.CLOSED:this.updateCrocClosed(e)}const{harry:t}=e;switch(f[t.scene].pit){case p.TAR:case p.QUICKSAND:t.checkSink(ut[0][0],ut[0][1]);break;case p.SHIFTING_TAR:case p.SHIFTING_QUICKSAND:this.pitOffset<5&&t.checkSink(ut[this.pitOffset][0],ut[this.pitOffset][1])}}render(e,t,n,i){const{pit:s}=f[n],r=ne[s===p.TAR||s==p.SHIFTING_TAR?0:1];if(s===p.SHIFTING_TAR||s===p.SHIFTING_QUICKSAND)I.difficulty!==R.HARD&&this.pitState!==At.OPENED&&(t.drawImage(ne[2][0],32-i,114),t.drawImage(ne[2][1],32-i,119)),this.pitState!==At.CLOSED&&(t.drawImage(r[0],0,0,64,5-this.pitOffset,32-i,114+this.pitOffset,64,5-this.pitOffset),t.drawImage(r[1],0,this.pitOffset,64,5-this.pitOffset,32-i,119,64,5-this.pitOffset));else if(t.drawImage(r[0],32-i,114),t.drawImage(r[1],32-i,119),s===p.CROCS){const s=_[e.sceneStates[n].enteredLeft?0:1],r=this.crocState===mt.OPENED?1:0;t.drawImage(s[r],44-i,111),t.drawImage(s[r],60-i,111),t.drawImage(s[r],76-i,111)}}}class Rt{xCounter;spriteCounter;constructor(e={xCounter:72,spriteCounter:0}){this.xCounter=e.xCounter,this.spriteCounter=e.spriteCounter}sync(){this.xCounter=Math.floor(this.xCounter)}checkRolled(e,t,n,i,s,r){const{harry:o}=e,a=(t+s)%x.WIDTH;1===this.computeFade(e,a,s,e.harry.scene,r)&&o.x>=a-3&&o.x<=a+2&&o.intersects(P[i],a-4,n)&&(e.harry.rolled(),e.score>0&&--e.score)}update(e){this.xCounter+=.5,this.xCounter===x.WIDTH&&(this.xCounter=0),this.spriteCounter=this.spriteCounter+1&15;const{harry:t}=e,{obsticles:n}=f[t.scene];if(!t.canBeHitByRollingLog()||n>A.THREE_ROLLING_LOGS)return;const i=e.sceneStates[t.scene].enteredLeft,s=Math.floor(i?this.xCounter:x.WIDTH-.5-this.xCounter),r=this.spriteCounter>>2,o=1&r,a=111+(0===r?1:0);switch(this.checkRolled(e,s,a,o,0,i),n){case A.TWO_ROLLING_LOGS_NEAR:this.checkRolled(e,s,a,o,16,i);break;case A.THREE_ROLLING_LOGS:this.checkRolled(e,s,a,o,64,i);case A.TWO_ROLLING_LOGS_FAR:this.checkRolled(e,s,a,o,32,i)}}fadeLog(e,t,n,i){if(e.sceneStates[t].enteredLeft!==n)return!0;const{obsticles:s}=f[t];switch(i){case 0:if(s>A.THREE_ROLLING_LOGS)return!0;break;case 16:if(s!==A.TWO_ROLLING_LOGS_NEAR)return!0;break;case 32:if(s!==A.TWO_ROLLING_LOGS_FAR&&s!==A.THREE_ROLLING_LOGS)return!0;break;case 64:if(s!==A.THREE_ROLLING_LOGS)return!0}return!1}computeFade(e,t,n,i,s){if(t<=15){let r=i-(e.harry.isUnderground()?3:1);if(r<0&&(r+=e.sceneStates.length),this.fadeLog(e,r,s,n))return(t+1)/17}else if(t>=x.WIDTH-15){let r=i+(e.harry.isUnderground()?3:1);if(r>=e.sceneStates.length&&(r-=e.sceneStates.length),this.fadeLog(e,r,s,n))return(x.WIDTH-t+1)/17}return 1}renderLog(e,t,n,i,s,r,o,a,l){const c=(i+r)%x.WIDTH;t.globalAlpha=this.computeFade(e,c,r,o,a),t.drawImage(Y[n],c-4-l,s),t.globalAlpha=1}render(e,t,n,i){const s=e.sceneStates[n].enteredLeft,r=Math.floor(s?this.xCounter:x.WIDTH-.5-this.xCounter),o=this.spriteCounter>>2,a=1&o,l=111+(0===o?1:0);switch(this.renderLog(e,t,a,r,l,0,n,s,i),f[n].obsticles){case A.TWO_ROLLING_LOGS_NEAR:this.renderLog(e,t,a,r,l,16,n,s,i);break;case A.THREE_ROLLING_LOGS:this.renderLog(e,t,a,r,l,64,n,s,i);case A.TWO_ROLLING_LOGS_FAR:this.renderLog(e,t,a,r,l,32,n,s,i)}}}class yt{constructor(e={}){}checkSkid(e,t,n){const{harry:i}=e;i.x>=t+1&&i.x<=t+6&&i.intersects(P[1],t,n)&&(i.skidded(),e.score>0&&--e.score)}update(e){switch(f[e.harry.scene].obsticles){case A.THREE_STATIONARY_LOGS:this.checkSkid(e,12,111),this.checkSkid(e,127,111);case A.ONE_STATIONARY_LOG:this.checkSkid(e,108,111)}}render(e,t,n,i){switch(f[n].obsticles){case A.THREE_STATIONARY_LOGS:t.drawImage(Y[1],12-i,111),t.drawImage(Y[1],127-i,111);case A.ONE_STATIONARY_LOG:t.drawImage(Y[1],108-i,111)}}}class It{seed;constructor(e={seed:1}){this.seed=e.seed}update(){let e=this.seed;e<<=1,e^=this.seed,e<<=1,this.seed=255&(this.seed<<1|(256&e?1:0))}getValue(){return this.seed>>4&1}}class St{constructor(e={}){}update(e){let t;switch(f[e.harry.scene].obsticles){case A.COBRA:t=H[e.sceneStates[e.harry.scene].enteredLeft?0:1][e.rattle.getValue()];break;case A.FIRE:t=U[e.rattle.getValue()];break;default:return}e.harry.intersects(t,108,111)&&e.harry.injure()}render(e,t,n,i){let s;switch(f[n].obsticles){case A.COBRA:s=k[e.sceneStates[n].enteredLeft?0:1][e.rattle.getValue()];break;case A.FIRE:s=K[e.rattle.getValue()];break;default:return}t.drawImage(s,108-i,111)}}class Ct{key;priority;degree;parent;child;left;right;mark;constructor(e,t){this.key=e,this.priority=t,this.degree=0,this.parent=null,this.child=null,this.left=this,this.right=this,this.mark=!1}}class Nt{min;nodeCount;constructor(){this.min=null,this.nodeCount=0}add(e,t){const n=new Ct(e,t);return this.min?(n.left=this.min,n.right=this.min.right,this.min.right&&(this.min.right.left=n),this.min.right=n,n.priority<this.min.priority&&(this.min=n)):this.min=n,this.nodeCount++,n}extractMin(){const e=this.min;if(!e)return null;if(e.child){let t=e.child;do{const e=t.right;t.left.right=t.right,t.right.left=t.left,t.left=this.min,t.right=this.min.right,this.min.right&&(this.min.right.left=t),this.min.right=t,t.parent=null,t=e}while(t!==e.child)}return e.left.right=e.right,e.right.left=e.left,e===e.right?this.min=null:(this.min=e.right,this.consolidate()),this.nodeCount--,e}decreasePriority(e,t){if(t>e.priority)throw new Error("New priority must be lower than the current priority.");e.priority=t;const n=e.parent;n&&e.priority<n.priority&&(this.cut(e,n),this.cascadingCut(n)),this.min&&e.priority<this.min.priority&&(this.min=e)}consolidate(){const e=[],t=Math.floor(Math.log2(this.nodeCount))+2;for(let n=0;n<t;n++)e[n]=null;const n=[];if(this.min){let e=this.min;do{n.push(e),e=e.right}while(e!==this.min)}for(const t of n){let n=t,i=n.degree;for(;e[i];){let t=e[i];n.priority>t.priority&&([n,t]=[t,n]),this.link(t,n),e[i]=null,i++}e[i]=n}this.min=null;for(const t of e)t&&(this.min?(t.left=this.min,t.right=this.min.right,this.min.right&&(this.min.right.left=t),this.min.right=t,t.priority<this.min.priority&&(this.min=t)):(this.min=t,t.left=t,t.right=t))}link(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right&&(t.child.right.left=e),t.child.right=e):(t.child=e,e.left=e,e.right=e),t.degree++,e.mark=!1}cut(e,t){e.right===e?t.child=null:(e.left.right=e.right,e.right.left=e.left,t.child===e&&(t.child=e.right)),t.degree--,e.left=this.min,e.right=this.min.right,this.min.right&&(this.min.right.left=e),this.min.right=e,e.parent=null,e.mark=!1}cascadingCut(e){const t=e.parent;t&&(e.mark?(this.cut(e,t),this.cascadingCut(t)):e.mark=!0)}size(){return this.nodeCount}peekMin(){return this.min}}function vt(e,t){const n=new Map,i=new Map,s=new Nt,r=new Map;for(const t of e.keys()){n.set(t,Number.POSITIVE_INFINITY),i.set(t,null);const e=s.add(t,Number.POSITIVE_INFINITY);r.set(t,e)}for(n.set(t,0),s.decreasePriority(r.get(t),0);s.size()>0;){const t=s.extractMin();if(!t)break;const o=t.key,a=n.get(o),l=e.get(o)||[];for(const{node:e,weight:t}of l){const l=a+t;l<n.get(e)&&(n.set(e,l),i.set(e,o),s.decreasePriority(r.get(e),l))}}const o=new Map;for(const t of e.keys())o.set(t,{distance:n.get(t),link:i.get(t)});return o}!function(e){e[e.RIGHT=0]="RIGHT",e[e.LEFT=1]="LEFT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"}(Et||(Et={})),function(e){e[e.UPPER=0]="UPPER",e[e.LOWER=1]="LOWER"}(Lt||(Lt={}));class xt{scene;tier;constructor(e,t){this.scene=e,this.tier=t}}class Gt{direction;constructor(e){this.direction=e}}function Dt(e){for(let t=0;t<bt.length;++t)if(e.sceneStates[bt[t]].treasure!==O.NONE){e.treasureMapIndex=t;break}}const bt=new Array(32),Tt=new Array(32);!function(){const e=function(){const e=new Array(f.length);for(let t=f.length-1;t>=0;--t)e[t]=[new xt(t,Lt.UPPER),new xt(t,Lt.LOWER)];return e}(),t=function(e){const t=new Map;for(let n=f.length-1;n>=0;--n){{const i=[];f[n].ladder&&i.push({node:e[n][Lt.LOWER],weight:165+f[n].difficulty});let s=n-1;s<0&&(s+=f.length);let r=n+1;r>=f.length&&(r-=f.length),i.push({node:e[s][Lt.UPPER],weight:f[n].difficulty+f[s].difficulty}),i.push({node:e[r][Lt.UPPER],weight:f[n].difficulty+f[r].difficulty}),t.set(e[n][Lt.UPPER],i)}{const i=[];f[n].ladder&&i.push({node:e[n][Lt.UPPER],weight:165+f[n].difficulty});let s=n-3;s<0&&(s+=f.length);let r=n+3;r>=f.length&&(r-=f.length),f[n].wall!==m.LEFT&&f[s].wall!==m.RIGHT&&i.push({node:e[s][Lt.LOWER],weight:10}),f[n].wall!==m.RIGHT&&f[r].wall!==m.LEFT&&i.push({node:e[r][Lt.LOWER],weight:10}),t.set(e[n][Lt.LOWER],i)}}return t}(e);let n=0;for(let i=0;i<f.length;++i){if(f[i].treasure===O.NONE)continue;bt[n]=i;const s=vt(t,e[i][Lt.UPPER]),r=Tt[n++]=new Array(f.length);for(let t=0;t<f.length;++t){r[t]=new Array(2);{const n=s.get(e[t][Lt.UPPER]);if(!n)throw new Error("Missing upper distLink");const{link:i}=n;let o=Et.RIGHT;if(i)if(i.tier===Lt.LOWER)o=Et.DOWN;else{let e=t-1;e<0&&(e+=f.length),o=i.scene===e?Et.LEFT:Et.RIGHT}r[t][Lt.UPPER]=new Gt(o)}{const n=s.get(e[t][Lt.LOWER]);if(!n)throw new Error("Missing lower distLink");const{link:i}=n;let o=Et.RIGHT;if(i)if(i.tier===Lt.UPPER)o=Et.UP;else{let e=t-3;e<0&&(e+=f.length),o=i.scene===e?Et.LEFT:Et.RIGHT}r[t][Lt.LOWER]=new Gt(o)}}}}();class Bt{constructor(e={}){}update(e){let t,n=0;switch(e.sceneStates[e.harry.scene].treasure){case O.DIAMOND_RING:t=$,n=5e3;break;case O.GOLD_BRICK:t=Q[e.rattle.getValue()],n=4e3;break;case O.SILVER_BRICK:t=j[e.rattle.getValue()],n=3e3;break;case O.MONEY_BAG:t=J,n=2e3;break;default:return}e.harry.intersects(t,108,111)&&(e.sceneStates[e.harry.scene].treasure=O.NONE,e.score+=n,32==++e.treasureCount?e.endGame():Dt(e),d("sfx/treasure.mp3"))}render(e,t,n,i){let s;switch(e.sceneStates[n].treasure){case O.DIAMOND_RING:s=z;break;case O.GOLD_BRICK:s=X[e.rattle.getValue()];break;case O.SILVER_BRICK:s=V[e.rattle.getValue()];break;case O.MONEY_BAG:s=Z;break;default:return}t.drawImage(s,108-i,111)}}class kt{minutes;seconds;frames;timeUp;constructor(e={minutes:I.difficulty===R.EASY?22:I.difficulty===R.NORMAL?21:20,seconds:0,frames:59,timeUp:!1}){this.minutes=e.minutes,this.seconds=e.seconds,this.frames=e.frames,this.timeUp=e.timeUp}update(){0!==this.minutes||0!==this.seconds||0!==this.frames?--this.frames>=0||(this.frames=59,--this.seconds>=0||(this.seconds=59,--this.minutes)):this.timeUp=!0}render(e){pe(e,this.minutes,29,16,D.OFF_WHITE),e.drawImage(te[D.OFF_WHITE][10],37,16),pe(e,this.seconds,53,16,D.OFF_WHITE,2)}}class Ht{enteredLeft=!0;treasure;constructor(e={enteredLeft:!0,treasure:O.NONE}){this.enteredLeft=e.enteredLeft,this.treasure=e.treasure}}class _t{sceneStates;harry;scorpion;vine;pit;rollingLog;stationaryLog;rattle;cobraAndFire;treasure;clock;scrollX;lastScrollX;ox;lastOx;nextOx;nextScene;lastNextScene;lastHarryUnderground;sceneAlpha;score;extraLives;gameOver;gameOverDelay;newHighScore;scoreColor;treasureCount;treasureMapIndex;constructor(e={sceneStates:void 0,harry:void 0,scorpion:void 0,vine:void 0,pit:void 0,rollingLog:void 0,stationaryLog:void 0,rattle:void 0,cobraAndFire:void 0,treasure:void 0,clock:void 0,scrollX:4,lastScrollX:4,ox:0,lastOx:0,nextOx:0,nextScene:0,lastNextScene:0,lastHarryUnderground:!1,sceneAlpha:1,score:2e3,extraLives:I.difficulty===R.EASY?4:I.difficulty===R.NORMAL?3:2,gameOver:!1,gameOverDelay:180,newHighScore:!1,scoreColor:D.OFF_WHITE,treasureCount:0,treasureMapIndex:0}){if(this.sceneStates=new Array(f.length),e.sceneStates?.length===f.length)for(let t=f.length-1;t>=0;--t)this.sceneStates[t]=new Ht(e.sceneStates[t]);else for(let e=f.length-1;e>=0;--e)this.sceneStates[e]=new Ht({enteredLeft:!0,treasure:f[e].treasure});this.harry=new ot(e.harry),this.scorpion=new ht(e.scorpion),this.vine=new dt(e.vine),this.pit=new wt(e.pit),this.rollingLog=new Rt(e.rollingLog),this.stationaryLog=new yt(e.stationaryLog),this.rattle=new It(e.rattle),this.cobraAndFire=new St(e.cobraAndFire),this.treasure=new Bt(e.treasure),this.clock=new kt(e.clock),this.scrollX=e.scrollX,this.lastScrollX=e.lastScrollX,this.ox=e.ox,this.lastOx=e.lastOx,this.nextOx=e.nextOx,this.nextScene=e.nextScene,this.lastNextScene=e.lastNextScene,this.lastHarryUnderground=e.lastHarryUnderground,this.sceneAlpha=e.sceneAlpha,this.score=e.score,this.extraLives=e.extraLives,this.gameOver=e.gameOver,this.gameOverDelay=e.gameOverDelay,this.newHighScore=e.newHighScore,this.scoreColor=e.scoreColor,this.treasureCount=e.treasureCount,this.treasureMapIndex=e.treasureMapIndex}endGame(){this.gameOver=!0,this.gameOverDelay=32===this.treasureCount?600:180,I.gameState=void 0,this.score>I.highScores[I.difficulty]&&(this.newHighScore=!0,I.highScores[I.difficulty]=this.score)}}const Mt=1/30,Ft=.5,Wt=4,Yt=[[0,32,92,124],[8,40,84,116],[16,48,76,108],[20,52,72,104]];let Pt;function Kt(){I.gameState=Pt=new _t(I.gameState),Dt(Pt)}function Ut(){if(function(e){let t=!1,n=!1,i=!1,s=!1,r=!1;e.harry.canStartClimbingUp()&&(0!==Ke&&0===e.harry.dir||0!==Pe&&1===e.harry.dir)?i=!0:e.harry.isClimbing()?Pe>Ke?e.harry.rightTouchMeansDown?i=!0:s=!0:Ke>Pe&&(e.harry.rightTouchMeansDown?s=!0:i=!0):Pe>Ke?Ke>0?(n=!0,r=!0):t=!0:Ke>Pe&&(Pe>0?(t=!0,r=!0):n=!0);let o=!1,a=!1,l=!1,c=!1,h=!1;const d=navigator.getGamepads();if(d)for(let e=d.length-1;e>=0;--e){const t=d[e];if(!t)continue;(t.buttons[14]?.pressed||t.buttons[4]?.pressed||t.buttons[10]?.pressed)&&(o=!0),(t.buttons[15]?.pressed||t.buttons[5]?.pressed||t.buttons[11]?.pressed)&&(a=!0),t.buttons[12]?.pressed&&(l=!0),t.buttons[13]?.pressed&&(c=!0);const n=t.axes[0],i=t.axes[2];n<-Oe||i<-Oe?o=!0:(n>Oe||i>Oe)&&(a=!0);const s=t.axes[1],r=t.axes[3];s<-Oe||r<-Oe?l=!0:(s>Oe||r>Oe)&&(c=!0),(t.buttons[0]?.pressed||t.buttons[1]?.pressed||t.buttons[2]?.pressed||t.buttons[3]?.pressed||t.buttons[6]?.pressed||t.buttons[7]?.pressed||t.buttons[8]?.pressed||t.buttons[9]?.pressed)&&(h=!0)}Ae=t||o||_e>Me,me=n||a||Me>_e,Ee=i||l||Fe>We,Le=s||c||We>Fe,we=r||h||Ye,Re=Ae&&!be,Ne=!Ae&&be,ye=me&&!Te,ve=!me&&Te,Ie=Ee&&!Be,xe=!Ee&&Be,Se=Le&&!ke,Ge=!Le&&ke,Ce=we&&!He,De=!we&&He,be=Ae,Te=me,Be=Ee,ke=Le,He=we}(Pt),Pt.gameOver)return Pt.newHighScore&&(Pt.scoreColor=Pt.scoreColor+1&255),Pt.gameOverDelay>0?void--Pt.gameOverDelay:void((Ie||Se||Re||ye||Ce)&&Kt());Pt.harry.teleported=!1;const e=Pt.harry.scene,t=Pt.nextScene;Pt.harry.isInjured()||(Pt.clock.update(),Pt.rattle.update(),Pt.cobraAndFire.update(Pt),Pt.treasure.update(Pt),Pt.scorpion.update(Pt),Pt.vine.update(Pt),Pt.pit.update(Pt),Pt.rollingLog.update(Pt),Pt.stationaryLog.update(Pt),Pt.sceneAlpha<1&&(Pt.sceneAlpha+=Mt,Pt.sceneAlpha>1&&(Pt.sceneAlpha=1))),Pt.harry.update(Pt);const n=Pt.harry.isUnderground();var i;Pt.lastHarryUnderground!==n&&(Pt.lastHarryUnderground=n,Pt.lastNextScene=Pt.nextScene,Pt.sceneAlpha=(i=1-Pt.sceneAlpha)<0?0:i>1?1:i);const s=Math.floor(Pt.harry.absoluteX);s<Pt.scrollX-Wt?Pt.lastScrollX===s||Pt.harry.teleported?Pt.scrollX-=Ft:Pt.scrollX-=Math.max(Ft,Pt.lastScrollX-s):s>Pt.scrollX+Wt&&(Pt.lastScrollX===s||Pt.harry.teleported?Pt.scrollX+=Ft:Pt.scrollX+=Math.max(Ft,s-Pt.lastScrollX)),Pt.lastScrollX=s,Pt.ox=Math.floor(Pt.harry.x)-68+Math.floor(Pt.scrollX)-s,Pt.lastOx!==Pt.ox&&(Pt.rollingLog.sync(),Pt.lastOx=Pt.ox),Pt.ox<0?(Pt.nextOx=Pt.ox+x.WIDTH,Pt.nextScene=Pt.harry.scene-(n?3:1),Pt.nextScene<0&&(Pt.nextScene+=f.length),Pt.nextScene!==e&&Pt.nextScene!==t&&(Pt.sceneStates[Pt.nextScene].enteredLeft=!1)):(Pt.nextOx=Pt.ox-x.WIDTH,Pt.nextScene=Pt.harry.scene+(n?3:1),Pt.nextScene>=f.length&&(Pt.nextScene-=f.length),Pt.nextScene!==e&&Pt.nextScene!==t&&(Pt.sceneStates[Pt.nextScene].enteredLeft=!0))}function Xt(e,t,n){const{trees:i,ladder:s,holes:r,wall:o,vine:a,pit:l,obsticles:c,scorpion:h}=f[t],d=Yt[i];if(I.difficulty===R.EASY){const i=Tt[Pt.treasureMapIndex][t];e.drawImage(ce[Lt.UPPER][i[Lt.UPPER].direction],60-n,75);const s=i[Lt.LOWER].direction;let r;switch(o){case m.LEFT:r=s===Et.RIGHT||s===Et.LEFT?52:53;break;case m.RIGHT:r=68;break;default:r=60}e.drawImage(ce[Lt.LOWER][i[Lt.LOWER].direction],r-n,150)}e.fillStyle=b[D.DARK_BROWN];for(let t=3;t>=0;--t)e.drawImage(ee,d[t]-2-n,51),e.fillRect(d[t]-n,59,4,52);if(s){e.fillStyle=b[D.BLACK],e.fillRect(60-n,116,8,6),e.fillRect(60-n,127,8,15),e.fillStyle=b[D.DARK_YELLOW];for(let t=10,i=130;t>=0;--t,i+=4)e.fillRect(62-n,i,4,2)}switch(r&&(e.fillStyle=b[D.BLACK],e.fillRect(32-n,116,12,6),e.fillRect(32-n,127,12,15),e.fillRect(84-n,116,12,6),e.fillRect(84-n,127,12,15)),o){case m.LEFT:e.drawImage(q,2-n,142),e.drawImage(q,2-n,158);break;case m.RIGHT:e.drawImage(q,120-n,142),e.drawImage(q,120-n,158)}switch(h&&Pt.scorpion.render(Pt,e,n),a&&Pt.vine.render(Pt,e,n),l!==p.NONE&&Pt.pit.render(Pt,e,t,n),Pt.sceneStates[t].treasure!==O.NONE&&Pt.treasure.render(Pt,e,t,n),c){case A.ONE_ROLLING_LOG:case A.TWO_ROLLING_LOGS_NEAR:case A.TWO_ROLLING_LOGS_FAR:case A.THREE_ROLLING_LOGS:Pt.rollingLog.render(Pt,e,t,n);break;case A.ONE_STATIONARY_LOG:case A.THREE_STATIONARY_LOGS:Pt.stationaryLog.render(Pt,e,t,n);break;case A.COBRA:case A.FIRE:Pt.cobraAndFire.render(Pt,e,t,n)}}function Qt(e,t,n){const{trees:i}=f[t];e.fillStyle=b[D.DARK_GREEN],e.fillRect(0,0,x.WIDTH,51);for(let t=1;t<5;++t)e.drawImage(W[1&t^1][i],(t-1<<5)-n,51,32,8);e.drawImage(W[0][i],0,0,2,4,128-n,51,8,8)}const Vt=1e3/60,jt=5;let Zt=!1,Jt=0,zt=0,$t=0;function qt(){Zt||(Zt=!0,$t=0,Jt=requestAnimationFrame(tn),zt=performance.now())}function en(){Zt&&(Zt=!1,cancelAnimationFrame(Jt))}function tn(){if(!Zt)return;Jt=requestAnimationFrame(tn),Rn();const e=performance.now(),t=e-zt;zt=e,$t+=t;let n=0;for(;$t>=Vt&&Zt;)if(Ut(),$t-=Vt,++n>jt){$t=0,zt=performance.now();break}}let nn,sn,rn,on,an,ln,cn,hn=null,dn=!1;function un(){!dn&&null===hn&&"wakeLock"in navigator&&(dn=!0,navigator.wakeLock.request("screen").then((e=>{dn&&(hn=e,hn.addEventListener("release",(()=>{dn||(hn=null)})))})).catch((e=>{})).finally((()=>dn=!1)))}let gn,fn,pn,On,An=null,mn=!1;function En(){if(null!==An&&(An(),An=null),mn)return;const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);e.addEventListener("change",En),An=()=>e.removeEventListener("change",En),yn()}function Ln(){mn||(mn=!0,en(),window.removeEventListener("click",$e),window.removeEventListener("mousemove",Je),window.removeEventListener("mouseenter",Je),window.removeEventListener("mouseleave",Ze),Ze(),window.removeEventListener("keydown",qe),window.removeEventListener("keyup",et),window.removeEventListener("touchstart",ze),window.removeEventListener("touchmove",ze),window.removeEventListener("touchend",ze),window.removeEventListener("touchcancel",ze),je(),g(),null!==hn&&"wakeLock"in navigator&&(dn=!1,hn.release().then((()=>{dn||(hn=null)})).catch((e=>{}))),window.removeEventListener("beforeunload",Sn),window.removeEventListener("resize",yn),window.removeEventListener("focus",In),window.removeEventListener("blur",In),document.removeEventListener("visibilitychange",In),null!==An&&(An(),An=null),S())}function wn(){Ln(),Dn()}function Rn(){rn?cn&&(rn.imageSmoothingEnabled=!1,rn.fillStyle="#0F0F0F",rn.fillRect(0,0,on,an),cn.imageSmoothingEnabled=!1,function(e){!function(e){e.fillStyle=b[D.GREEN],e.fillRect(0,51,x.WIDTH,60),e.fillStyle=b[D.LIGHT_YELLOW],e.fillRect(0,111,x.WIDTH,16),e.fillStyle=b[D.DARK_YELLOW],e.fillRect(0,127,x.WIDTH,15),e.fillRect(0,174,x.WIDTH,6),e.fillStyle=b[D.BLACK],e.fillRect(0,142,x.WIDTH,32)}(e),Xt(e,Pt.harry.scene,Pt.ox),1===Pt.sceneAlpha?Xt(e,Pt.nextScene,Pt.nextOx):(e.globalAlpha=1-Pt.sceneAlpha,Xt(e,Pt.lastNextScene,Pt.nextOx),e.globalAlpha=Pt.sceneAlpha,Xt(e,Pt.nextScene,Pt.nextOx),e.globalAlpha=1),Pt.harry.render(Pt,e,Pt.ox),Qt(e,Pt.harry.scene,Pt.ox),1===Pt.sceneAlpha?Qt(e,Pt.nextScene,Pt.nextOx):(e.globalAlpha=1-Pt.sceneAlpha,Qt(e,Pt.lastNextScene,Pt.nextOx),e.globalAlpha=Pt.sceneAlpha,Qt(e,Pt.nextScene,Pt.nextOx),e.globalAlpha=1),function(e){pe(e,Pt.score,45,3,Pt.scoreColor),Pt.clock.render(e),e.fillStyle=b[D.OFF_WHITE];for(let t=Pt.extraLives-1,n=5;t>=0;--t,n+=2)e.fillRect(n,16,1,8);if(I.difficulty!==R.HARD){pe(e,Pt.harry.scene+1,116,3,D.OFF_WHITE),pe(e,Pt.treasureCount,92,16,D.OFF_WHITE);const t=te[D.OFF_WHITE];e.drawImage(t[10],100,16),e.drawImage(t[3],108,16),e.drawImage(t[2],116,16)}}(e)}(cn),rn.drawImage(ln,pn,On,gn,fn),rn.imageSmoothingEnabled=!0,rn.fillStyle="#FFFFFF",rn.fillRect(27,21,18,1),rn.fillRect(27,27,18,1),rn.fillRect(27,33,18,1)):yn()}function yn(){if(mn)return;rn=null,sn=document.getElementById("main-canvas"),sn.style.display="none";const e=window.innerWidth,t=window.innerHeight;sn.style.display="block",sn.style.width=`${e}px`,sn.style.height=`${t}px`,sn.style.position="absolute",sn.style.left="0px",sn.style.top="0px",nn=window.devicePixelRatio||1,sn.width=Math.floor(nn*e),sn.height=Math.floor(nn*t);const n=new DOMMatrix;e>=t?(on=e,an=t,n.a=n.d=nn,n.b=n.c=n.e=n.f=0):(on=t,an=e,n.a=n.d=n.e=0,n.c=nn,n.b=-n.c,n.f=nn*t),rn=sn.getContext("2d"),rn&&(rn.setTransform(n),fn=an,gn=fn*G.WIDTH/G.HEIGHT,gn>on?(gn=on,fn=gn*G.HEIGHT/G.WIDTH,pn=0,On=Math.round((an-fn)/2)):(pn=Math.round((on-gn)/2),On=0),Rn())}function In(){!mn&&"visible"===document.visibilityState&&document.hasFocus()?(un(),je(),qt()):(en(),g())}function Sn(){Ln()}let Cn,Nn,vn=!1;const xn=new Array(3);let Gn;function Dn(){Gn=I.difficulty,document.body.style.backgroundColor="#0F0F0F",window.addEventListener("resize",Hn),window.addEventListener("touchmove",Bn,{passive:!1}),document.getElementById("main-content").innerHTML=`\n            <div id="start-container">\n                <div id="start-div">\n                    <div id="high-score-div">High Score: ${I.highScores[Gn]}</div>\n                    <div class="volume-div">\n                        <span class="left-volume-label material-icons" id="left-volume-span" \n                                lang="en">volume_mute</span>\n                        <input type="range" id="volume-input" min="0" max="100" step="any" value="10">\n                        <span class="right-volume-label" id="right-volume-span" lang="en">100</span>\n                    </div>\n                    <div class="difficulty-div">\n                        <div id="dropdown-label">Difficulty:</div>\n                        <div id="custom-dropdown" class="custom-dropdown">\n                            <div class="dropdown-selected">${function(){switch(I.difficulty){case R.EASY:return"Easy";case R.NORMAL:return"Normal";default:return"Hard"}}()}</div>\n                            <div class="dropdown-options">\n                                <div class="dropdown-option" data-value="0">Easy</div>\n                                <div class="dropdown-option" data-value="1">Normal</div>\n                                <div class="dropdown-option" data-value="2">Hard</div>\n                            </div>\n                        </div>    \n                    </div>    \n                    <div id="go-div">${I.gameState?'<button id="start-button">New Game</button><button id="continue-button">Continue</button>':'<button id="start-button">Start</button>'}\n                    </div>\n                </div>\n            </div>`;const e=document.getElementById("high-score-div"),t=document.getElementById("volume-input");t.addEventListener("input",kn),t.value=String(I.volume),document.getElementById("start-button").addEventListener("click",bn);const n=document.getElementById("continue-button");n?.addEventListener("click",Tn);const i=document.getElementById("custom-dropdown"),s=i.querySelector(".dropdown-selected"),r=i.querySelectorAll(".dropdown-option");Cn=()=>i.classList.toggle("open"),s.addEventListener("click",Cn),Nn=e=>{i.contains(e.target)||i.classList.remove("open")},document.addEventListener("click",Nn),r.forEach((t=>{const n=Number(t.getAttribute("data-value"));xn[n]=()=>{Gn=n,e.textContent=`High Score: ${I.highScores[Gn]}`,s.textContent=t.textContent,i.classList.remove("open")},t.addEventListener("click",xn[n])})),Hn()}function bn(){I.gameState=void 0,I.difficulty=Gn,Tn()}function Tn(){h(I.volume),function(){window.removeEventListener("resize",Hn),window.removeEventListener("touchmove",Bn),document.getElementById("volume-input").removeEventListener("input",kn),document.getElementById("start-button").removeEventListener("click",bn);const e=document.getElementById("continue-button");e?.removeEventListener("click",Tn);const t=document.getElementById("custom-dropdown");document.removeEventListener("click",Nn),t.querySelector(".dropdown-selected").removeEventListener("click",Cn),t.querySelectorAll(".dropdown-option").forEach((e=>e.removeEventListener("click",xn[Number(e.getAttribute("data-value"))]))),S()}(),mn=!1,Kt(),document.body.style.backgroundColor="#C2BCB1",ln=new OffscreenCanvas(x.WIDTH,x.HEIGHT),cn=ln.getContext("2d"),document.getElementById("main-content").innerHTML='<canvas id="main-canvas" class="canvas" width="1" height="1"></canvas>',sn=document.getElementById("main-canvas"),sn.style.touchAction="none",window.addEventListener("beforeunload",Sn),window.addEventListener("resize",yn),window.addEventListener("focus",In),window.addEventListener("blur",In),document.addEventListener("visibilitychange",In),un(),En(),window.addEventListener("click",$e),window.addEventListener("mousemove",Je),window.addEventListener("mouseenter",Je),window.addEventListener("mouseleave",Ze),Je(),window.addEventListener("touchstart",ze,{passive:!1}),window.addEventListener("touchmove",ze,{passive:!1}),window.addEventListener("touchend",ze,{passive:!1}),window.addEventListener("touchcancel",ze,{passive:!1}),window.addEventListener("keydown",qe),window.addEventListener("keyup",et),je(),qt()}function Bn(e){let t=e.target;for(;null!==t;){if("volume-input"===t.id){if(vn)return;const n=t,i=parseFloat(n.max),s=parseFloat(n.min),r=n.getBoundingClientRect(),o=(1-(e.touches[0].clientY-r.top)/r.height)*(i-s)+s;return n.value=o.toString(),void n.dispatchEvent(new Event("input"))}t=t.parentElement}e.preventDefault()}function kn(){const e=document.getElementById("left-volume-span"),t=document.getElementById("volume-input"),n=document.getElementById("right-volume-span");I.volume=100*(+t.value-+t.min)/(+t.max-+t.min),t.style.setProperty("--thumb-position",`${I.volume}%`),0===I.volume?e.textContent="volume_off":I.volume<33?e.textContent="volume_mute":I.volume<66?e.textContent="volume_down":e.textContent="volume_up",n.textContent=String(Math.round(I.volume))}function Hn(){const e=document.getElementById("start-container"),t=document.getElementById("start-div"),n=document.getElementById("left-volume-span"),i=document.getElementById("right-volume-span");e.style.width=e.style.height="",e.style.left=e.style.top="",e.style.display="none",t.style.left=t.style.top=t.style.transform="",t.style.display="none";const s=window.innerWidth,r=window.innerHeight;if(vn=s>=r,e.style.left="0px",e.style.top="0px",e.style.width=`${s}px`,e.style.height=`${r}px`,e.style.display="block",t.style.display="flex",n.style.width="",n.style.display="inline-block",n.style.textAlign="center",n.textContent="ðŸ”‡",n.style.transform="",i.style.width="",i.style.display="inline-block",i.style.textAlign="center",i.textContent="100",vn){const e=n.getBoundingClientRect().width;n.style.width=`${e}px`;const o=i.getBoundingClientRect().width;i.style.width=`${o}px`;const a=t.getBoundingClientRect();t.style.left=(s-a.width)/2+"px",t.style.top=(r-a.height)/2+"px"}else{const e=n.getBoundingClientRect().height;n.style.width=`${e}px`;const o=i.getBoundingClientRect().height;i.style.width=`${o}px`,t.style.transform="rotate(-90deg)";const a=t.getBoundingClientRect();t.style.left=(s-a.height)/2+"px",t.style.top=(r-a.width)/2+"px"}i.textContent=String(I.volume),kn()}let _n,Mn=!1;function Fn(e){if(_n){if(e===_n.style.color)return;_n.style.color=e}const t="progress-bar-style";let n=document.getElementById(t);n||(n=document.createElement("style"),n.id=t,document.head.appendChild(n)),n.innerText=`\n        #loading-progress::-webkit-progress-value {\n            background-color: ${e} !important;\n        }\n        #loading-progress::-moz-progress-bar {\n            background-color: ${e} !important;\n        }\n    `}function Wn(e){_n&&(_n.value=100*e.data,Fn("#48D800"))}function Yn(e){n.e(96).then(n.t.bind(n,710,23)).then((({default:t})=>{(new t).loadAsync(e).then((e=>Object.entries(e.files).forEach((e=>{const[t,n]=e;var i,r;n.dir||t.endsWith(".mp3")&&(i=t,r=n,a.push(r.async("arraybuffer").then((e=>s.decodeAudioData(e))).then((e=>l.set(i,e)))))}))))})),async function(){return Promise.all(a).then((()=>a.length=0))}().then((()=>{document.getElementById("loading-progress").value=100,setTimeout((()=>{!function(){if(I)return;const e=localStorage.getItem(w);if(e)try{I=JSON.parse(e),I.gameState=I.gameState&&!I.gameState.gameOver?new _t(I.gameState):void 0}catch{I=new y}else I=new y}(),async function(){let e;!function(e){e[e.CLIMBCOLTAB=0]="CLIMBCOLTAB",e[e.RUNCOLTAB=22]="RUNCOLTAB",e[e.LOGCOLOR=43]="LOGCOLOR",e[e.FIRECOLOR=59]="FIRECOLOR",e[e.COBRACOLOR=75]="COBRACOLOR",e[e.CROCOCOLOR=91]="CROCOCOLOR",e[e.MONEYBAGCOLOR=107]="MONEYBAGCOLOR",e[e.SCORPIONCOLOR=123]="SCORPIONCOLOR",e[e.WALLCOLOR=139]="WALLCOLOR",e[e.RINGCOLOR=155]="RINGCOLOR",e[e.GOLDBARCOLOR=171]="GOLDBARCOLOR",e[e.SILVERBARCOLOR=187]="SILVERBARCOLOR",e[e.LEAVESCOLOR=203]="LEAVESCOLOR",e[e.BRANCHESCOLOR=207]="BRANCHESCOLOR",e[e.LEAVES0=215]="LEAVES0",e[e.LEAVES1=219]="LEAVES1",e[e.LEAVES2=223]="LEAVES2",e[e.LEAVES3=227]="LEAVES3",e[e.HARRY0=231]="HARRY0",e[e.HARRY1=253]="HARRY1",e[e.HARRY2=275]="HARRY2",e[e.HARRY3=297]="HARRY3",e[e.HARRY4=319]="HARRY4",e[e.HARRY5=341]="HARRY5",e[e.HARRY6=363]="HARRY6",e[e.HARRY7=385]="HARRY7",e[e.BRANCHES=407]="BRANCHES",e[e.PIT=415]="PIT",e[e.LOG0=420]="LOG0",e[e.FIRE0=436]="FIRE0",e[e.COBRA0=452]="COBRA0",e[e.COBRA1=468]="COBRA1",e[e.CROCO0=484]="CROCO0",e[e.CROCO1=500]="CROCO1",e[e.MONEYBAG=516]="MONEYBAG",e[e.SCORPION0=532]="SCORPION0",e[e.SCORPION1=548]="SCORPION1",e[e.WALL=564]="WALL",e[e.BAR0=580]="BAR0",e[e.BAR1=596]="BAR1",e[e.RING=612]="RING",e[e.ZERO=628]="ZERO",e[e.ONE=636]="ONE",e[e.TWO=644]="TWO",e[e.THREE=652]="THREE",e[e.FOUR=660]="FOUR",e[e.SIX=676]="SIX",e[e.SEVEN=684]="SEVEN",e[e.EIGHT=692]="EIGHT",e[e.NINE=700]="NINE",e[e.COLON=708]="COLON",e[e.ARROWRIGHT=716]="ARROWRIGHT",e[e.ARROWLEFT=732]="ARROWLEFT",e[e.ARROWUP=748]="ARROWUP",e[e.ARROWDOWN=764]="ARROWDOWN"}(e||(e={}));const t=function(){const e=new Array(256),t=atob("AAAAPz8+ZGRjhISDoqKhurq50tLR6urpPT0AXl4Ke3sVmZkgtLQqzc005uY+/f1IcSMAhj0LmVcYrW8mvYYyzZs+3LBJ6sJUhhUAmi8OrkgewGEv0Xc+4I1N76Jb/bVoigAAnhMSsSgnwj080lFQ4mRj73V0/YaFeQBYjRJuoCeEsTuYwE6q0GG83XHM6oLcRQB4XRKPciekiDu5m07KrmHcv3Hs0IL7DgCFKROZQyitXT2/dFHQi2TfoXXutYb7AACKEhOdJCiwNz3BSVHRWmTganXueYb7ABV9EjGTJEynN2e7SYDMWpfdaq7tecL7ACdYEkV0JGKNN36nSZe+WrDUasfoed37ADUmEldCJHZdN5V2SbGOWsylauW7ef3PADkAE1sSKHknPZc8UbNQZM1jdeZ0hv2FDjIAK1QRR3MjY5M2fbBIlctZreVpwv14Jy4ARU4PYmshfogzl6NDsLxTx9Ri3epwPSMAXkINe18dmXsttJY7za9K5sdX/d1k");for(let n=0;n<=255;++n){const i=3*(n>>1),s=new v(t.charCodeAt(i),t.charCodeAt(i+1),t.charCodeAt(i+2));e[n]=s,b[n]=`#${(s.r<<16|s.g<<8|s.b).toString(16).padStart(6,"0")}`}return e}(),n=atob("0tLS0tLS0tLS0tLSyMjIyMjISkpKEtLS0tLS0tLS0tLIyMjIyMjISkpKEhISEhISEhISEhISEhISEhIQEBAQED4+Pi4uLi4uLi4uAAAEAAQAAAAAAAAAAABCQtDQ0NDQ0NDQ0NDQ0NDQ0NAEBAQEBAQEBAQEBAQSBAQEDg4ODg4ODg4ODg4ODg4ODgZCQkIGQkJCBkJCQgZCQkJCQh4eHh4eHh4eDg4ODg4OHh4eHh4eHh4ODg4ODg4ODgYGBgYGBgYODg4ODg4ODg7S0tLSEBAQEBAQEBABg8//ABg9fxi8/v8wePz+AAAAAAAzctoeHBhYWHw+GhgQGBgYAACAgMNiYjY+HBgYPD46OBgYEBgYGAAQICIkNDIWHhwYGBwcGBgYGBAYGBgADAgoKD4KDhwYGBwcGBgYGBgQGBgYAAACQ0R0FBwcGBgYPD46OBgYEBgYGAAYEBwYGBgYGBgYGBgcHhoYGBAYGBgAAAAAAAAAY/L23MDAwMDA8NCQ0NDAADAQEBAWFBQWEhYeHBg4ODweGgIYGBh+25mZmZmZmQABAw9/ABgkWlpaZn5edn5edjwYAADD5348GDx8fHg4ODAwEBAA/vn5+flgEAgMDAg4MEAAAP75+fr6YBAIDAwIODCAAAAAAAAA/6sDAwsuuuCAAAAAAAAAAP+rVf8GBAAAAAAAAD53d2N7Y29jNjYcCBw2AIUyPXj4xoKQiNhwAAAAAABJMzx4+sSSiNhwAAAAAAAA/rq6uv7u7u7+urq6/u7u7gD4/P7+fj4AEABUAJIAEAAA+Pz+/n4+AAAoAFQAEAAAAAA4bERERGw4EDh8OAAAADxmZmZmZmY8PBgYGBgYOBh+YGA8BgZGPDxGBgwMBkY8DAwMfkwsHAx8RgYGfGBgfjxmZmZ8YGI8GBgYGAwGQn48ZmY8PGZmPDxGBj5mZmY8ABgYAAAYGAAACAgMDP7+///+/gwMCAgAABAQMDB/f///f38wMBAQABAQODh8fP7+ODg4ODg4ODg4ODg4ODg4OP7+fHw4OBAQ"),i=[];for(let s=0;s<2;++s){const r=1===s;W[s]=new Array(4);for(let o=0;o<4;++o)ue(n,t,e.LEAVES0+4*o,e.LEAVESCOLOR,4,r,(e=>W[s][o]=e),null,i);T[s]=new Array(8),B[s]=new Array(8);for(let o=0;o<8;++o){const a=o<=5?5-o:o;ue(n,t,e.HARRY0+22*o,7===o?e.CLIMBCOLTAB:e.RUNCOLTAB,22,r,(e=>T[s][a]=e),(e=>B[s][a]=e),i)}k[s]=new Array(2),H[s]=new Array(2),ue(n,t,e.COBRA1,e.COBRACOLOR,16,r,(e=>k[s][0]=e),(e=>H[s][0]=e),i),ue(n,t,e.COBRA0,e.COBRACOLOR,16,r,(e=>k[s][1]=e),(e=>H[s][1]=e),i),_[s]=new Array(2),ue(n,t,e.CROCO1,e.CROCOCOLOR,16,r,(e=>_[s][0]=e),null,i),ue(n,t,e.CROCO0,e.CROCOCOLOR,16,r,(e=>_[s][1]=e),null,i),M[s]=new Array(2),F[s]=new Array(2),ue(n,t,e.SCORPION1,e.SCORPIONCOLOR,16,r,(e=>M[s][0]=e),(e=>F[s][0]=e),i),ue(n,t,e.SCORPION0,e.SCORPIONCOLOR,16,r,(e=>M[s][1]=e),(e=>F[s][1]=e),i)}ue(n,t,e.LOG0,e.LOGCOLOR,16,!0,(e=>Y[0]=e),(e=>P[0]=e),i),ue(n,t,e.LOG0,e.LOGCOLOR,16,!1,(e=>Y[1]=e),(e=>P[1]=e),i),ue(n,t,e.FIRE0,e.FIRECOLOR,16,!0,(e=>K[0]=e),(e=>U[0]=e),i),ue(n,t,e.FIRE0,e.FIRECOLOR,16,!1,(e=>K[1]=e),(e=>U[1]=e),i),ue(n,t,e.BAR1,e.GOLDBARCOLOR,16,!1,(e=>X[0]=e),(e=>Q[0]=e),i),ue(n,t,e.BAR0,e.GOLDBARCOLOR,16,!1,(e=>X[1]=e),(e=>Q[1]=e),i),ue(n,t,e.BAR1,e.SILVERBARCOLOR,16,!1,(e=>V[0]=e),(e=>j[0]=e),i),ue(n,t,e.BAR0,e.SILVERBARCOLOR,16,!1,(e=>V[1]=e),(e=>j[1]=e),i),ue(n,t,e.MONEYBAG,e.MONEYBAGCOLOR,16,!1,(e=>Z=e),(e=>J=e),i),ue(n,t,e.RING,e.RINGCOLOR,16,!1,(e=>z=e),(e=>$=e),i),ue(n,t,e.WALL,e.WALLCOLOR,16,!1,(e=>q=e),null,i),ue(n,t,e.BRANCHES,e.BRANCHESCOLOR,8,!1,(e=>ee=e),null,i);for(let s=0;s<256;++s){const r=t[s];te[s]=new Array(11);for(let t=0;t<11;++t)i.push(he(8,8,(i=>{const s=e.ZERO+8*(t+1)-1;for(let e=0;e<8;++e){const t=n.charCodeAt(s-e);for(let n=0,s=128;n<8;++n,s>>=1)t&s&&ge(i,n,e,r)}})).then((({imageBitmap:e})=>te[s][t]=e)))}const s=[D.BLACK,D.BLUE,D.MID_YELLOW];for(let r=0;r<s.length;++r){const o=t[s[r]];ne[r]=new Array(2);for(let t=0;t<2;++t)i.push(he(64,5,(i=>{for(let s=0;s<5;++s){const r=0===t?4-s:s,a=n.charCodeAt(e.PIT+s);for(let e=0,t=128,n=0;e<8;++e,t>>=1,n+=4)if(!(a&t))for(let e=0;e<4;++e){const t=n+e;ge(i,31-t,r,o),ge(i,32+t,r,o)}}})).then((({imageBitmap:e})=>ne[r][t]=e)))}!function(e,t){const n=245/145,i=Math.atan(1/n);let s=se,r=re,o=se,a=re;for(let e=0;e<ie;++e){const t=C*e/ie,l=i*Math.sin(t),c=new N(Math.round(se+73*n*Math.sin(l)/2),Math.round(re+73*Math.cos(l)),-73*i*C*Math.sin(l)*Math.cos(t)/ie);oe[e]=c,s=Math.min(s,c.x),r=Math.min(r,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}const l=e[D.DARK_BROWN],c=new ImageData(o-s+1,a-r+1);for(let e=0;e<oe.length;++e){const n=oe[e];c.data.fill(0),fe(c,se-s,re-r,n.x-s,n.y-r,l),le[e]=de(c),t.push(createImageBitmap(c).then((t=>ae[e]=t)))}}(t,i);const r=[D.OFF_GREEN,D.OFF_BLACK];for(let s=0;s<r.length;++s){const o=t[r[s]];ce[s]=new Array(4);for(let t=0;t<4;++t)i.push(he(8,16,(i=>{const s=e.ARROWRIGHT+16*t;for(let e=0;e<16;++e){const t=n.charCodeAt(s+e);for(let n=0,s=128;n<8;++n,s>>=1)t&s&&ge(i,n,e,o)}})).then((({imageBitmap:e})=>ce[s][t]=e)))}await Promise.all(i)}().then((()=>{window.removeEventListener("resize",Kn),window.removeEventListener("touchmove",Pn),"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("message",Wn),Dn()}))}),10)}))}function Pn(e){e.preventDefault()}function Kn(){const e=document.getElementById("progress-container"),t=document.getElementById("progress-div");e.style.width=e.style.height="",e.style.left=e.style.top="",e.style.display="none",t.style.top=t.style.left=t.style.transform="",t.style.display="none";const n=window.innerWidth,i=window.innerHeight;if(Mn=n>=i,e.style.left="0px",e.style.top="0px",e.style.width=`${n}px`,e.style.height=`${i}px`,e.style.display="block",t.style.display="flex",Mn){const e=t.getBoundingClientRect();t.style.left=(n-e.width)/2+"px",t.style.top=(i-e.height)/2+"px"}else{t.style.transform="rotate(-90deg)";const e=t.getBoundingClientRect();t.style.left=(n-e.height)/2+"px",t.style.top=(i-e.width)/2+"px"}}let Un=!1;function Xn(e){e.preventDefault()}function Qn(){const e=document.getElementById("death-div");e.style.top=e.style.left=e.style.transform="",e.style.display="none";const t=window.innerWidth,n=window.innerHeight;if(Un=t>=n,e.style.display="flex",Un){const i=e.getBoundingClientRect();e.style.left=(t-i.width)/2+"px",e.style.top=(n-i.height)/2+"px"}else{e.style.transform="rotate(-90deg)";const i=e.getBoundingClientRect();e.style.left=(t-i.height)/2+"px",e.style.top=(n-i.width)/2+"px"}}function Vn(){window.addEventListener("error",(e=>{console.error(`Caught in global handler: ${e.message}`,{source:e.filename,lineno:e.lineno,colno:e.colno,error:e.error}),e.preventDefault(),window.addEventListener("resize",Qn),window.addEventListener("touchmove",Xn,{passive:!1}),document.getElementById("main-content").innerHTML='<div id="death-div"><span id="fatal-error">&#x1F480;</span></div>',Qn()})),window.addEventListener("unhandledrejection",(e=>e.preventDefault())),document.addEventListener("dblclick",(e=>e.preventDefault()),{passive:!1}),window.addEventListener("resize",Kn),window.addEventListener("touchmove",Pn,{passive:!1}),document.getElementById("main-content").innerHTML='\n            <div id="progress-container">\n                <div id="progress-div">\n                    <progress id="loading-progress" value="0" max="100"></progress>\n                </div>\n            </div>',_n=document.getElementById("loading-progress"),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",Wn),Kn(),async function(){for(let t=i-1;t>=0;--t)try{const t=await fetch("resources.zip");if(!t.ok)continue;const n=t.headers.get("Content-Length");if(!n)continue;const i=parseInt(n);if(isNaN(i)||i<=0)continue;const s=t.body;if(null===s)continue;const r=s.getReader(),o=[];let a=0;for(;;){const{done:t,value:n}=await r.read();if(t)break;o.push(n),a+=n.length,e=a/i,_n.value=100*e,Fn("#0075FF")}const l=new Uint8Array(a);let c=0;return o.forEach((e=>{l.set(e,c),c+=e.length})),l}catch(e){if(0===t)throw e}var e;throw new Error("Failed to fetch.")}().then(Yn)}}}]);