"use strict";(self.webpackChunkpitfall_js=self.webpackChunkpitfall_js||[]).push([[524],{157:(e,t,n)=>{n.r(t),n.d(t,{init:()=>Jn});const i=5,s=new AudioContext;s.onstatechange=()=>{"suspended"===s.state&&A()};let r=null;function o(){return r||(r=s.resume(),r.then((()=>r=null)).catch((()=>r=null))),r}let a=null,l=!0;document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?(l=!0,"suspended"===s.state&&o()):"hidden"===document.visibilityState&&(l=!1,A(),"running"===s.state&&(a||(a=s.suspend(),a.then((()=>a=null)).catch((()=>a=null)))))}));const c=s.createGain();c.connect(s.destination),c.gain.value=.1;const h=[],d=new Map,u=new Map;function g(e){"suspended"!==s.state?c.gain.value=e/100:l&&o().then((()=>g(e)))}function f(e,t=!1){if("suspended"===s.state)return void(l&&o().then((()=>f(e))));if(t){if(u.has(e))return}else O(e);const n=s.createBufferSource();n.buffer=d.get(e),n.connect(c),n.loop=t,u.set(e,n),n.onended=()=>u.delete(e),n.start()}function O(e){const t=u.get(e);t&&(u.delete(e),t.stop())}function A(){for(const e of u.values())e.stop();u.clear()}const p=new Array(255);var m,E,L,w;!function(e){e[e.TAR=0]="TAR",e[e.QUICKSAND=1]="QUICKSAND",e[e.CROCS=2]="CROCS",e[e.SHIFTING_TAR=3]="SHIFTING_TAR",e[e.SHIFTING_QUICKSAND=4]="SHIFTING_QUICKSAND",e[e.NONE=5]="NONE"}(m||(m={})),function(e){e[e.MONEY_BAG=0]="MONEY_BAG",e[e.SILVER_BRICK=1]="SILVER_BRICK",e[e.GOLD_BRICK=2]="GOLD_BRICK",e[e.DIAMOND_RING=3]="DIAMOND_RING",e[e.NONE=4]="NONE"}(E||(E={})),function(e){e[e.ONE_ROLLING_LOG=0]="ONE_ROLLING_LOG",e[e.TWO_ROLLING_LOGS_NEAR=1]="TWO_ROLLING_LOGS_NEAR",e[e.TWO_ROLLING_LOGS_FAR=2]="TWO_ROLLING_LOGS_FAR",e[e.THREE_ROLLING_LOGS=3]="THREE_ROLLING_LOGS",e[e.ONE_STATIONARY_LOG=4]="ONE_STATIONARY_LOG",e[e.THREE_STATIONARY_LOGS=5]="THREE_STATIONARY_LOGS",e[e.FIRE=6]="FIRE",e[e.COBRA=7]="COBRA",e[e.NONE=8]="NONE"}(L||(L={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.NONE=2]="NONE"}(w||(w={}));class R{trees;ladder;holes;vine;pit;treasure;obsticles;wall;scorpion;difficulty;constructor(e,t,n,i,s,r,o,a,l,c){this.trees=e,this.ladder=t,this.holes=n,this.vine=i,this.pit=s,this.treasure=r,this.obsticles=o,this.wall=a,this.scorpion=l,this.difficulty=c}}let y=196;for(let e=0;e<p.length;++e){let t=304;const n=y>>6;let i=!1,s=!1,r=!1,o=m.NONE,a=E.NONE,l=L.NONE,c=w.NONE;switch(y>>3&7){case 0:i=!0,t+=5;break;case 1:i=!0,s=!0,t+=10;break;case 2:r=!0,o=m.TAR,t+=143;break;case 3:r=!0,o=m.QUICKSAND,t+=143;break;case 4:r=1==(y>>1&1),o=m.CROCS,t+=r?143:240;break;case 5:o=m.SHIFTING_TAR,a=3&y,t+=111;break;case 6:o=m.SHIFTING_TAR,r=!0,t+=111;break;case 7:o=m.SHIFTING_QUICKSAND,t+=111}if(a===E.NONE&&o!==m.CROCS)switch(l=7&y,l){case L.ONE_STATIONARY_LOG:case L.THREE_STATIONARY_LOGS:case L.ONE_ROLLING_LOG:t+=5;break;case L.TWO_ROLLING_LOGS_FAR:t+=10;break;case L.TWO_ROLLING_LOGS_NEAR:t+=15;break;case L.THREE_ROLLING_LOGS:t+=20;break;case L.FIRE:case L.COBRA:t+=30}i&&(c=y>>7&1),p[e]=new R(n,i,s,r,o,a,l,c,!i,t),y=255&(y<<1|y>>7&1^y>>5&1^y>>4&1^y>>3&1)}const I="pitfall-store";var S;!function(e){e[e.EASY=0]="EASY",e[e.NORMAL=1]="NORMAL",e[e.HARD=2]="HARD"}(S||(S={}));class C{highScores=[0,0,0];volume=10;difficulty=0;gameState=void 0}let N;function v(){N.gameState?.gameOver&&(N.gameState=void 0),localStorage.setItem(I,JSON.stringify(N))}const x=2*Math.PI;class G{x;y;vy;constructor(e,t,n){this.x=e,this.y=t,this.vy=n}}class D{r;g;b;constructor(e,t,n){this.r=e,this.g=t,this.b=n}}var b,T,B;!function(e){e[e.WIDTH=136]="WIDTH",e[e.HEIGHT=180]="HEIGHT"}(b||(b={})),function(e){e[e.WIDTH=3.4]="WIDTH",e[e.HEIGHT=2.3684210526315788]="HEIGHT"}(T||(T={})),function(e){e[e.BROWN=18]="BROWN",e[e.YELLOW=30]="YELLOW",e[e.ORANGE=62]="ORANGE",e[e.RED=72]="RED",e[e.OFF_GREEN=213]="OFF_GREEN",e[e.GREEN=214]="GREEN",e[e.BLUE=164]="BLUE",e[e.YELLOW_GREEN=200]="YELLOW_GREEN",e[e.PINK=74]="PINK",e[e.BLACK=0]="BLACK",e[e.OFF_BLACK=2]="OFF_BLACK",e[e.GREY=6]="GREY",e[e.OFF_WHITE=12]="OFF_WHITE",e[e.WHITE=14]="WHITE",e[e.DARK_GREEN=210]="DARK_GREEN",e[e.DARK_RED=66]="DARK_RED",e[e.DARK_YELLOW=20]="DARK_YELLOW",e[e.MID_YELLOW=22]="MID_YELLOW",e[e.LIGHT_YELLOW=24]="LIGHT_YELLOW",e[e.DARK_BROWN=16]="DARK_BROWN"}(B||(B={}));const k=new Array(256),H=new Array(2),_=new Array(2),M=new Array(2),F=new Array(2),W=new Array(2),Y=new Array(2),P=new Array(2),K=new Array(2),U=new Array(2),X=new Array(2),Q=new Array(2),V=new Array(2),j=new Array(2),Z=new Array(2),J=new Array(2),z=new Array(2);let $,q,ee,te,ne,ie;const se=new Array(256),re=new Array(3),oe=285,ae=64,le=28,ce=new Array(oe),he=new Array(oe),de=new Array(oe),ue=new Array(2);async function ge(e,t,n){return new Promise((i=>{const s=new ImageData(e,t);n(s),createImageBitmap(s).then((e=>i({imageBitmap:e,imageData:s})))}))}function fe(e){const t=new Array(e.height),{data:n}=e;for(let i=0,s=3;i<e.height;++i){t[i]=new Array(e.width);for(let r=0;r<e.width;++r,s+=4)t[i][r]=0!==n[s]}return t}function Oe(e,t,n,i,s,r,o,a,l){l.push(ge(8,s,(o=>{if(r)for(let r=0;r<s;++r){const a=s-1-r,l=e.charCodeAt(n+a),c=t[e.charCodeAt(i+a)];for(let e=0,t=1;e<8;++e,t<<=1)l&t&&Ae(o,e,r,c)}else for(let r=0;r<s;++r){const a=s-1-r,l=e.charCodeAt(n+a),c=t[e.charCodeAt(i+a)];for(let e=0,t=128;e<8;++e,t>>=1)l&t&&Ae(o,e,r,c)}})).then((({imageBitmap:e,imageData:t})=>{o(e),a&&a(fe(t))})))}function Ae(e,t,n,i){const s=4*(n*e.width+t),r=e.data;r[s]=i.r,r[s+1]=i.g,r[s+2]=i.b,r[s+3]=255}function pe(e,t,n,i,s,r){const o=Math.abs(i-t),a=t<i?1:-1,l=-Math.abs(s-n),c=n<s?1:-1;let h=o+l;for(;Ae(e,t,n,r),t!==i||n!==s;){const e=2*h;e>=l&&(h+=l,t+=a),e<=o&&(h+=o,n+=c)}}function me(e,t,n,i,s,r=1){const o=se[s];for(;t>0||r>0;)e.drawImage(o[t%10],n,i),t=Math.floor(t/10),--r,n-=8}const Ee=.5;let Le=!1,we=!1,Re=!1,ye=!1,Ie=!1,Se=!1,Ce=!1,Ne=!1,ve=!1,xe=!1,Ge=!1,De=!1,be=!1,Te=!1,Be=!1,ke=!1,He=!1,_e=!1,Me=!1,Fe=!1,We=0,Ye=0,Pe=0,Ke=0,Ue=!1,Xe=0,Qe=0,Ve=null,je=!1;class Ze{timestampDown=0;xDown=0;yDown=0;x=0;y=0}const Je=new Map;function ze(){We=0,Ye=0,Pe=0,Ke=0,Ue=!1,Xe=0,Qe=0,Je.clear()}function $e(){null!==Ve&&(clearTimeout(Ve),Ve=null),je&&(document.body.style.cursor="default",je=!1)}function qe(){$e(),Ve=window.setTimeout((()=>{document.body.style.cursor="none",je=!0}),3e3)}function et(e){e.preventDefault();const t=window.innerWidth,n=window.innerHeight,i=t>=n;for(let t=e.changedTouches.length-1;t>=0;--t){const s=e.changedTouches[t];let r,o;switch(i?(r=s.clientX,o=s.clientY):(r=n-1-s.clientY,o=s.clientX),e.type){case"touchstart":{const e=new Ze;e.timestampDown=Date.now(),e.xDown=e.x=r,e.yDown=e.y=o,Je.set(s.identifier,e);break}case"touchmove":{qe();const e=Je.get(s.identifier);e&&(e.x=r,e.y=o);break}case"touchend":case"touchcancel":{const e=Je.get(s.identifier);e&&(r<64&&o<64&&e.xDown<64&&e.yDown<64&&In(),Je.delete(s.identifier));break}}}const s=t/2;Xe=Qe=0;for(const[t,n]of Array.from(Je)){n.x<s?(n.x>=64||n.y>=64)&&(Xe=n.timestampDown):Qe=n.timestampDown;e:{for(let n=e.touches.length-1;n>=0;--n)if(e.touches[n].identifier===t)break e;Je.delete(t)}}}function tt(e){if(!e.clientX||!e.clientY)return;const t=window.innerWidth,n=window.innerHeight;let i,s;t>=n?(i=e.clientX,s=e.clientY):(i=n-1-e.clientY,s=e.clientX),i<64&&s<64&&In()}function nt(e){switch(e.code){case"KeyA":case"ArrowLeft":We=Ye+1;break;case"KeyD":case"ArrowRight":Ye=We+1;break;case"KeyW":case"ArrowUp":Pe=Ke+1;break;case"KeyS":case"ArrowDown":Ke=Pe+1;break;case"Escape":In();break;default:Ue=!0}}function it(e){switch(e.code){case"KeyA":case"ArrowLeft":We=0;break;case"KeyD":case"ArrowRight":Ye=0;break;case"KeyW":case"ArrowUp":Pe=0;break;case"KeyS":case"ArrowDown":Ke=0;break;case"Escape":break;default:Ue=!1}}const st=119,rt=174,ot=22/289,at=17*-ot;var lt;!function(e){e[e.STANDING=0]="STANDING",e[e.FALLING=1]="FALLING",e[e.CLIMBING=2]="CLIMBING",e[e.INJURED=3]="INJURED",e[e.SWINGING=4]="SWINGING",e[e.SINKING=5]="SINKING",e[e.KNEELING=6]="KNEELING",e[e.SKIDDING=7]="SKIDDING"}(lt||(lt={}));class ct{mainState;lastMainState;scene;absoluteX;x;y;vy;dir;sprite;runCounter;climbCounter;teleported;injuredCounter;tunnelSpawning;releasedVine;swallow;kneeling;kneelingDelay;rightTouchMeansDown;rollingDelay;constructor(e={mainState:lt.STANDING,lastMainState:lt.STANDING,scene:0,absoluteX:4,x:4,y:st,vy:0,dir:0,sprite:0,runCounter:0,climbCounter:0,teleported:!1,injuredCounter:0,tunnelSpawning:!1,releasedVine:!1,swallow:!1,kneeling:!1,kneelingDelay:!1,rightTouchMeansDown:!1,rollingDelay:0}){this.mainState=e.mainState,this.lastMainState=e.lastMainState,this.scene=e.scene,this.absoluteX=e.absoluteX,this.x=e.x,this.y=e.y,this.vy=e.vy,this.dir=e.dir,this.sprite=e.sprite,this.runCounter=e.runCounter,this.climbCounter=e.climbCounter,this.teleported=e.teleported,this.injuredCounter=e.injuredCounter,this.tunnelSpawning=e.tunnelSpawning,this.releasedVine=e.releasedVine,this.swallow=e.swallow,this.kneeling=e.kneeling,this.kneelingDelay=e.kneelingDelay,this.rightTouchMeansDown=e.rightTouchMeansDown,this.rollingDelay=e.rollingDelay}intersects(e,t,n){return function(e,t,n,i,s,r){t=Math.floor(t),n=Math.floor(n);const o=e[0].length-1,a=e.length-1;s=Math.floor(s)-t,r=Math.floor(r)-n;const l=s+i[0].length-1,c=r+i.length-1;if(c<0||a<r||l<0||o<s)return!1;const h=Math.max(0,s),d=Math.min(o,l),u=Math.max(0,r),g=Math.min(a,c);for(let t=u;t<=g;++t)for(let n=h;n<=d;++n)if(e[t][n]&&i[t-r][n-s])return!0;return!1}(e,t,n,_[this.dir][this.sprite],Math.floor(this.x)-4,Math.floor(this.y)-22)}canBeHitByRollingLog(){return this.mainState===lt.STANDING||this.mainState===lt.KNEELING||this.mainState===lt.CLIMBING}isClimbing(){return this.mainState===lt.CLIMBING}isFalling(){return this.mainState===lt.FALLING}isUnderground(){switch(this.mainState){case lt.SINKING:case lt.SWINGING:case lt.SKIDDING:case lt.KNEELING:return!1}return this.y>146}teleport(e){this.teleported=!0,this.setX(e)}setX(e){this.incrementX(e-this.x)}incrementX(e){this.absoluteX+=e,this.x+=e,this.x<0?(this.x+=b.WIDTH,this.y>st?this.scene-=3:--this.scene,this.scene<0&&(this.scene+=p.length)):this.x>=b.WIDTH&&(this.x-=b.WIDTH,this.y>st?this.scene+=3:++this.scene,this.scene>=p.length&&(this.scene-=p.length))}startFalling(e,t){this.mainState=lt.FALLING,this.y+=t,this.vy=ot+t,this.sprite=2,this.kneeling=!1,this.updateShift(e)}endFalling(e,t){this.mainState=lt.STANDING,this.y=t,this.vy=0,this.sprite=2,this.runCounter=0,this.tunnelSpawning=!1,this.releasedVine=!1,this.updateShift(e)}startClimbing(e){this.mainState=lt.CLIMBING,this.teleport(64),this.y=e,this.sprite=7,this.kneeling=!1,this.climbCounter=0,this.rightTouchMeansDown=134===e!=(0!==this.dir)}endClimbing(e,t,n){this.mainState=lt.STANDING,this.teleport(e),this.y=t,this.runCounter=0,this.sprite=0,this.dir=n}updateShift(e){const{wall:t}=p[this.scene];let n=!1;if(we){let e=!0;this.y>=120&&(t===w.RIGHT&&119===this.x||t===w.LEFT&&1===this.x)?e=!1:this.y>st&&this.y<=157&&(this.x>=32&&this.x<=44?this.x>43.5&&(e=!1):this.x>=84&&this.x<=96&&this.x>95.5&&(e=!1)),e&&(this.incrementX(.5),this.dir=0,n=!0)}else if(Le){let e=!0;this.y>=120&&(t===w.LEFT&&10===this.x||t===w.RIGHT&&128===this.x)?e=!1:this.y>st&&this.y<=157&&(this.x>=32&&this.x<=43?this.x<32.5&&(e=!1):this.x>=84&&this.x<=95&&this.x<84.5&&(e=!1)),e&&(this.incrementX(-.5),this.dir=1,n=!0)}return n}canStartClimbingUp(){return this.mainState==lt.STANDING&&this.y===rt&&this.x>=56&&this.x<=72&&!(Le||we||Re||ye||Ie)}updateStanding(e){const{ladder:t,holes:n}=p[this.scene];if(n&&this.y===st&&(this.x>=32&&this.x<=44||this.x>=84&&this.x<=96))return this.startFalling(e,ot),e.score=Math.max(0,e.score-100),void f("sfx/fall.mp3");if(Ie)return this.startFalling(e,at),void f("sfx/jump.mp3");if(t){if(this.y===st&&(this.x>=60&&this.x<=67||(ye&&!Le&&!we||ve)&&this.x>=56&&this.x<=72))return void this.startClimbing(134);if(this.y===rt&&(Re&&!Le&&!we||Ne)&&this.x>=56&&this.x<=72)return void this.startClimbing(this.y)}this.updateShift(e)?(0===this.runCounter&&6==++this.sprite&&(this.sprite=1),this.runCounter=this.runCounter+1&3):(this.runCounter=0,this.sprite=this.lastMainState===lt.FALLING?2:0)}updateFalling(e){const{ladder:t,holes:n,wall:i}=p[this.scene];if(t&&this.y>=134&&this.y<rt&&this.x>=60&&this.x<=67){const e=Math.floor((this.y-134)/4);return this.startClimbing(134+4*e),void(this.dir^=1&e)}const s=this.y+this.vy;if(this.y<=st&&s>=st){if(t&&this.x>=60&&this.x<=67)return void this.startClimbing(134);if(!n||this.x<32||this.x>95||this.x>43&&this.x<84)return void this.endFalling(e,st)}this.y<=rt&&s>=rt?this.endFalling(e,rt):(this.y+=this.vy,this.vy+=ot,this.sprite=5,this.updateShift(e))}climbUpward(){134===this.y?this.climbCounter=0:++this.climbCounter>=8&&(this.climbCounter=0,this.y-=4,this.dir^=1)}climbDownward(){return this.y===rt?(this.endClimbing(this.x,rt,this.dir),!0):(++this.climbCounter>=8&&(this.climbCounter=0,this.y+=4,this.dir^=1),!1)}updateClimbing(e){if(this.y<=142){if(134===this.y&&Re)return void(this.rightTouchMeansDown?this.endClimbing(59,st,1):this.endClimbing(69,st,0));if(Ce||xe&&0===this.dir)return void this.endClimbing(69,st,0);if(Se||xe&&1===this.dir)return void this.endClimbing(59,st,1)}if(this.y>=170&&!Re&&(Le||we))this.endClimbing(this.x,rt,this.dir);else if(Re)this.climbUpward();else if(ye&&this.climbDownward())return}isInjured(){return this.mainState===lt.INJURED||this.mainState===lt.SINKING}injure(){this.mainState=lt.INJURED,this.injuredCounter=20,f("sfx/die.mp3")}startTunnelSpawn(e){if(0===e.extraLives)return void e.endGame();let t;--e.extraLives,this.mainState=lt.FALLING,this.tunnelSpawning=!0,0===this.dir?(t=this.x-38,t<4&&(t=this.x+38)):(t=this.x+38,t>=140&&(t=this.x-38)),this.teleport(t),this.y=149,this.vy=0,this.sprite=2}startTreeSpawn(e){0!==e.extraLives?(--e.extraLives,this.mainState=lt.FALLING,this.teleport(0===this.dir?8:127),this.y=51,this.vy=0,this.sprite=2,this.swallow=!1):e.endGame()}updateInjured(e){0!=--this.injuredCounter||(this.isUnderground()?this.startTunnelSpawn(e):this.startTreeSpawn(e))}swing(){this.mainState=lt.SWINGING,this.sprite=6,this.teleported=!0,f("sfx/swing.mp3")}updateSwinging(e){const t=ce[e.vine.sprite];if(this.setX(0===this.dir?t.x+1:t.x),this.y=t.y+17,0===this.dir&&Ce||1===this.dir&&Se)return this.startFalling(e,t.vy),void(this.releasedVine=!0)}checkSink(e,t){const n=Math.floor(this.x);return!(this.mainState!==lt.STANDING||this.y!==st||n<e||n>t||(this.mainState=lt.SINKING,this.sprite=0,f("sfx/die.mp3"),0))}checkSwallow(e,t){const n=Math.floor(this.x);n<e||n>t||(this.swallow=!0)}updateSinking(e){++this.y>163&&this.startTreeSpawn(e)}startKnelling(){this.mainState=lt.KNEELING,this.sprite=5,this.kneeling=!0,this.kneelingDelay=!0}rolled(){switch(f("sfx/kneel.mp3",!0),this.rollingDelay=2,this.mainState){case lt.STANDING:case lt.KNEELING:this.startKnelling();break;case lt.CLIMBING:this.climbDownward()}}skidded(){switch(f("sfx/kneel.mp3",!0),this.rollingDelay=2,this.mainState){case lt.STANDING:case lt.SKIDDING:this.mainState=lt.SKIDDING,this.sprite=5,this.kneeling=!0,this.kneelingDelay=!0}}updateKneeling(e){this.kneelingDelay?this.kneelingDelay=!1:(this.mainState=lt.STANDING,this.sprite=0,this.kneeling=!1,O("sfx/kneel.mp3"))}updateSkidding(e){this.updateKneeling(e),this.updateStanding(e)}update(e){const t=this.mainState;switch(this.mainState){case lt.STANDING:this.updateStanding(e);break;case lt.FALLING:this.updateFalling(e);break;case lt.CLIMBING:this.updateClimbing(e);break;case lt.INJURED:this.updateInjured(e);break;case lt.SWINGING:this.updateSwinging(e);break;case lt.SINKING:this.updateSinking(e);break;case lt.KNEELING:this.updateKneeling(e);break;case lt.SKIDDING:this.updateSkidding(e)}this.lastMainState=t,this.rollingDelay>0&&0==--this.rollingDelay&&O("sfx/kneel.mp3")}render(e,t,n){const i=H[this.dir][this.kneeling?5:this.sprite],s=Math.floor(this.x)-4-n,r=this.kneeling?102:Math.floor(this.y)-22;if(this.mainState===lt.SINKING)if(this.swallow){if(r<121){t.drawImage(i,0,0,8,121-r,s,r,8,121-r);const o=W[e.sceneStates[this.scene].enteredLeft?0:1];t.drawImage(o[0],0,9,8,2,44-n,120,8,2),t.drawImage(o[0],0,9,8,2,60-n,120,8,2),t.drawImage(o[0],0,9,8,2,76-n,120,8,2)}}else r<119&&t.drawImage(i,0,0,8,119-r,s,r,8,119-r);else this.tunnelSpawning&&r>=127&&r<142?t.drawImage(i,0,142-r,8,r-100,s,142,8,r-100):r<101||r>=127?t.drawImage(i,s,r):(r<122&&t.drawImage(i,0,0,8,122-r,s,r,8,122-r),r>106&&t.drawImage(i,0,127-r,8,r-105,s,127,8,r-105))}}const ht=b.WIDTH/2,dt=b.WIDTH-4,ut=b.WIDTH/8;class gt{x;X;dir;sprite;updateCounter;constructor(e={x:ht,X:ht,dir:0,sprite:0,updateCounter:8}){this.x=e.x,this.X=e.X,this.dir=e.dir,this.sprite=e.sprite,this.updateCounter=e.updateCounter}update(e){const t=p[e.harry.scene].scorpion&&e.harry.isUnderground();if(t&&e.harry.intersects(P[this.dir][this.sprite],Math.floor(this.x)-4,158))e.harry.injure();else if(!(--this.updateCounter>0)){if(this.updateCounter=8,this.sprite^=1,t&&Math.abs(e.harry.x-this.x)>=ut){const t=this.dir;if(this.dir=this.x>e.harry.x?1:0,t!==this.dir)return}0===this.dir?this.x>=dt?this.dir=1:++this.x:this.x<=4?this.dir=0:--this.x}}render(e,t,n){t.drawImage(Y[this.dir][this.sprite],Math.floor(this.x)-4-n,158)}}class ft{sprite;constructor(e={sprite:Math.floor(ce.length/2)}){this.sprite=e.sprite}update(e){++this.sprite===ce.length&&(this.sprite=0);const{harry:t}=e;p[t.scene].vine&&!t.releasedVine&&t.isFalling()&&t.intersects(de[this.sprite],33,28)&&t.swing()}render(e,t,n){t.drawImage(he[this.sprite],33-n,28)}}const Ot=[[33,95],[37,91],[41,87],[49,79],[61,67]],At=[[33,43],[53,59],[69,75],[85,95]],pt=[[33,48],[53,64],[69,80],[85,95]],mt=[[33,43],[48,59],[64,75],[80,95]],Et=[[45,51],[61,67],[77,83]];var Lt,wt,Rt,yt;!function(e){e[e.OPENED=0]="OPENED",e[e.CLOSING=1]="CLOSING",e[e.CLOSED=2]="CLOSED",e[e.OPENING=3]="OPENING"}(Lt||(Lt={})),function(e){e[e.OPENED=0]="OPENED",e[e.CLOSED=1]="CLOSED"}(wt||(wt={}));class It{pitState;pitOffset;pitCounter;crocState;crocCounter;constructor(e={pitState:Lt.OPENED,pitOffset:0,pitCounter:71,crocState:wt.CLOSED,crocCounter:192}){this.pitState=e.pitState,this.pitOffset=e.pitOffset,this.pitCounter=e.pitCounter,this.crocState=e.crocState,this.crocCounter=e.crocCounter}updatePitOpened(e){--this.pitCounter>=0||(this.pitState=Lt.CLOSING,this.pitCounter=4,++this.pitOffset)}updatePitClosing(e){if(!(--this.pitCounter>=0))return 5==++this.pitOffset?(this.pitState=Lt.CLOSED,void(this.pitCounter=143)):void(this.pitCounter=4)}updatePitClosed(e){--this.pitCounter>=0||(this.pitState=Lt.OPENING,this.pitCounter=4,--this.pitOffset)}updatePitOpening(e){if(!(--this.pitCounter>=0))return 0==--this.pitOffset?(this.pitState=Lt.OPENED,void(this.pitCounter=71)):void(this.pitCounter=4)}updateCrocOpened(e){if(0==--this.crocCounter)return this.crocState=wt.CLOSED,this.crocCounter=193,void this.updateCrocClosed(e);const{harry:t,sceneStates:n}=e;if(p[t.scene].pit!==m.CROCS)return;const i=n[t.scene].enteredLeft?pt:mt;for(let e=i.length-1;e>=0;--e){const n=i[e];if(t.checkSink(n[0],n[1])){for(let e=Et.length-1;e>=0;--e){const n=Et[e];t.checkSwallow(n[0],n[1])}break}}}updateCrocClosed(e){if(0==--this.crocCounter)return this.crocState=wt.OPENED,this.crocCounter=129,void this.updateCrocOpened(e);const{harry:t}=e;if(p[t.scene].pit===m.CROCS)for(let e=At.length-1;e>=0;--e){const n=At[e];if(t.checkSink(n[0],n[1]))break}}update(e){switch(this.pitState){case Lt.OPENED:this.updatePitOpened(e);break;case Lt.CLOSING:this.updatePitClosing(e);break;case Lt.CLOSED:this.updatePitClosed(e);break;case Lt.OPENING:this.updatePitOpening(e)}switch(this.crocState){case wt.OPENED:this.updateCrocOpened(e);break;case wt.CLOSED:this.updateCrocClosed(e)}const{harry:t}=e;switch(p[t.scene].pit){case m.TAR:case m.QUICKSAND:t.checkSink(Ot[0][0],Ot[0][1]);break;case m.SHIFTING_TAR:case m.SHIFTING_QUICKSAND:this.pitOffset<5&&t.checkSink(Ot[this.pitOffset][0],Ot[this.pitOffset][1])}}render(e,t,n,i){const{pit:s}=p[n],r=re[s===m.TAR||s==m.SHIFTING_TAR?0:1];if(s===m.SHIFTING_TAR||s===m.SHIFTING_QUICKSAND)N.difficulty!==S.HARD&&this.pitState!==Lt.OPENED&&(t.drawImage(re[2][0],32-i,114),t.drawImage(re[2][1],32-i,119)),this.pitState!==Lt.CLOSED&&(t.drawImage(r[0],0,0,64,5-this.pitOffset,32-i,114+this.pitOffset,64,5-this.pitOffset),t.drawImage(r[1],0,this.pitOffset,64,5-this.pitOffset,32-i,119,64,5-this.pitOffset));else if(t.drawImage(r[0],32-i,114),t.drawImage(r[1],32-i,119),s===m.CROCS){const s=W[e.sceneStates[n].enteredLeft?0:1],r=this.crocState===wt.OPENED?1:0;t.drawImage(s[r],44-i,111),t.drawImage(s[r],60-i,111),t.drawImage(s[r],76-i,111)}}}class St{xCounter;spriteCounter;constructor(e={xCounter:72,spriteCounter:0}){this.xCounter=e.xCounter,this.spriteCounter=e.spriteCounter}sync(){this.xCounter=Math.floor(this.xCounter)}checkRolled(e,t,n,i,s,r){const{harry:o}=e,a=(t+s)%b.WIDTH;1===this.computeFade(e,a,s,e.harry.scene,r)&&o.x>=a-3&&o.x<=a+3&&o.intersects(X[i],a-4,n)&&(e.harry.rolled(),e.score>0&&--e.score)}update(e){this.xCounter+=.5,this.xCounter===b.WIDTH&&(this.xCounter=0),this.spriteCounter=this.spriteCounter+1&15;const{harry:t}=e,{obsticles:n}=p[t.scene];if(!t.canBeHitByRollingLog()||n>L.THREE_ROLLING_LOGS)return;const i=e.sceneStates[t.scene].enteredLeft,s=Math.floor(i?this.xCounter:b.WIDTH-.5-this.xCounter),r=this.spriteCounter>>2,o=1&r,a=111+(0===r?1:0);switch(this.checkRolled(e,s,a,o,0,i),n){case L.TWO_ROLLING_LOGS_NEAR:this.checkRolled(e,s,a,o,16,i);break;case L.THREE_ROLLING_LOGS:this.checkRolled(e,s,a,o,64,i);case L.TWO_ROLLING_LOGS_FAR:this.checkRolled(e,s,a,o,32,i)}}fadeLog(e,t,n,i){if(e.sceneStates[t].enteredLeft!==n)return!0;const{obsticles:s}=p[t];switch(i){case 0:if(s>L.THREE_ROLLING_LOGS)return!0;break;case 16:if(s!==L.TWO_ROLLING_LOGS_NEAR)return!0;break;case 32:if(s!==L.TWO_ROLLING_LOGS_FAR&&s!==L.THREE_ROLLING_LOGS)return!0;break;case 64:if(s!==L.THREE_ROLLING_LOGS)return!0}return!1}computeFade(e,t,n,i,s){if(t<=15){let r=i-(e.harry.isUnderground()?3:1);if(r<0&&(r+=e.sceneStates.length),this.fadeLog(e,r,s,n))return(t+1)/17}else if(t>=b.WIDTH-15){let r=i+(e.harry.isUnderground()?3:1);if(r>=e.sceneStates.length&&(r-=e.sceneStates.length),this.fadeLog(e,r,s,n))return(b.WIDTH-t+1)/17}return 1}renderLog(e,t,n,i,s,r,o,a,l){const c=(i+r)%b.WIDTH;t.globalAlpha=this.computeFade(e,c,r,o,a),t.drawImage(U[n],c-4-l,s),t.globalAlpha=1}render(e,t,n,i){const s=e.sceneStates[n].enteredLeft,r=Math.floor(s?this.xCounter:b.WIDTH-.5-this.xCounter),o=this.spriteCounter>>2,a=1&o,l=111+(0===o?1:0);switch(this.renderLog(e,t,a,r,l,0,n,s,i),p[n].obsticles){case L.TWO_ROLLING_LOGS_NEAR:this.renderLog(e,t,a,r,l,16,n,s,i);break;case L.THREE_ROLLING_LOGS:this.renderLog(e,t,a,r,l,64,n,s,i);case L.TWO_ROLLING_LOGS_FAR:this.renderLog(e,t,a,r,l,32,n,s,i)}}}class Ct{constructor(e={}){}checkSkid(e,t,n){const{harry:i}=e;i.x>=t+1&&i.x<=t+7&&i.intersects(X[1],t,n)&&(i.skidded(),e.score>0&&--e.score)}update(e){switch(p[e.harry.scene].obsticles){case L.THREE_STATIONARY_LOGS:this.checkSkid(e,12,111),this.checkSkid(e,127,111);case L.ONE_STATIONARY_LOG:this.checkSkid(e,108,111)}}render(e,t,n,i){switch(p[n].obsticles){case L.THREE_STATIONARY_LOGS:t.drawImage(U[1],12-i,111),t.drawImage(U[1],127-i,111);case L.ONE_STATIONARY_LOG:t.drawImage(U[1],108-i,111)}}}class Nt{seed;constructor(e={seed:1}){this.seed=e.seed}update(){let e=this.seed;e<<=1,e^=this.seed,e<<=1,this.seed=255&(this.seed<<1|(256&e?1:0))}getValue(){return this.seed>>4&1}}class vt{constructor(e={}){}update(e){let t;switch(p[e.harry.scene].obsticles){case L.COBRA:t=F[e.sceneStates[e.harry.scene].enteredLeft?0:1][e.rattle.getValue()];break;case L.FIRE:t=V[e.rattle.getValue()];break;default:return}e.harry.intersects(t,108,111)&&e.harry.injure()}render(e,t,n,i){let s;switch(p[n].obsticles){case L.COBRA:s=M[e.sceneStates[n].enteredLeft?0:1][e.rattle.getValue()];break;case L.FIRE:s=Q[e.rattle.getValue()];break;default:return}t.drawImage(s,108-i,111)}}class xt{key;priority;degree;parent;child;left;right;mark;constructor(e,t){this.key=e,this.priority=t,this.degree=0,this.parent=null,this.child=null,this.left=this,this.right=this,this.mark=!1}}class Gt{min;nodeCount;constructor(){this.min=null,this.nodeCount=0}add(e,t){const n=new xt(e,t);return this.min?(n.left=this.min,n.right=this.min.right,this.min.right&&(this.min.right.left=n),this.min.right=n,n.priority<this.min.priority&&(this.min=n)):this.min=n,this.nodeCount++,n}extractMin(){const e=this.min;if(!e)return null;if(e.child){let t=e.child;do{const e=t.right;t.left.right=t.right,t.right.left=t.left,t.left=this.min,t.right=this.min.right,this.min.right&&(this.min.right.left=t),this.min.right=t,t.parent=null,t=e}while(t!==e.child)}return e.left.right=e.right,e.right.left=e.left,e===e.right?this.min=null:(this.min=e.right,this.consolidate()),this.nodeCount--,e}decreasePriority(e,t){if(t>e.priority)throw new Error("New priority must be lower than the current priority.");e.priority=t;const n=e.parent;n&&e.priority<n.priority&&(this.cut(e,n),this.cascadingCut(n)),this.min&&e.priority<this.min.priority&&(this.min=e)}consolidate(){const e=[],t=Math.floor(Math.log2(this.nodeCount))+2;for(let n=0;n<t;n++)e[n]=null;const n=[];if(this.min){let e=this.min;do{n.push(e),e=e.right}while(e!==this.min)}for(const t of n){let n=t,i=n.degree;for(;e[i];){let t=e[i];n.priority>t.priority&&([n,t]=[t,n]),this.link(t,n),e[i]=null,i++}e[i]=n}this.min=null;for(const t of e)t&&(this.min?(t.left=this.min,t.right=this.min.right,this.min.right&&(this.min.right.left=t),this.min.right=t,t.priority<this.min.priority&&(this.min=t)):(this.min=t,t.left=t,t.right=t))}link(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right&&(t.child.right.left=e),t.child.right=e):(t.child=e,e.left=e,e.right=e),t.degree++,e.mark=!1}cut(e,t){e.right===e?t.child=null:(e.left.right=e.right,e.right.left=e.left,t.child===e&&(t.child=e.right)),t.degree--,e.left=this.min,e.right=this.min.right,this.min.right&&(this.min.right.left=e),this.min.right=e,e.parent=null,e.mark=!1}cascadingCut(e){const t=e.parent;t&&(e.mark?(this.cut(e,t),this.cascadingCut(t)):e.mark=!0)}size(){return this.nodeCount}peekMin(){return this.min}}function Dt(e,t){const n=new Map,i=new Map,s=new Gt,r=new Map;for(const t of e.keys()){n.set(t,Number.POSITIVE_INFINITY),i.set(t,null);const e=s.add(t,Number.POSITIVE_INFINITY);r.set(t,e)}for(n.set(t,0),s.decreasePriority(r.get(t),0);s.size()>0;){const t=s.extractMin();if(!t)break;const o=t.key,a=n.get(o),l=e.get(o)||[];for(const{node:e,weight:t}of l){const l=a+t;l<n.get(e)&&(n.set(e,l),i.set(e,o),s.decreasePriority(r.get(e),l))}}const o=new Map;for(const t of e.keys())o.set(t,{distance:n.get(t),link:i.get(t)});return o}!function(e){e[e.RIGHT=0]="RIGHT",e[e.LEFT=1]="LEFT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"}(Rt||(Rt={})),function(e){e[e.UPPER=0]="UPPER",e[e.LOWER=1]="LOWER"}(yt||(yt={}));class bt{scene;tier;constructor(e,t){this.scene=e,this.tier=t}}class Tt{direction;constructor(e){this.direction=e}}function Bt(e){for(let t=0;t<kt.length;++t)if(e.sceneStates[kt[t]].treasure!==E.NONE){e.treasureMapIndex=t;break}}const kt=new Array(32),Ht=new Array(32);!function(){const e=function(){const e=new Array(p.length);for(let t=p.length-1;t>=0;--t)e[t]=[new bt(t,yt.UPPER),new bt(t,yt.LOWER)];return e}(),t=function(e){const t=new Map;for(let n=p.length-1;n>=0;--n){{const i=[];p[n].ladder&&i.push({node:e[n][yt.LOWER],weight:165+p[n].difficulty});let s=n-1;s<0&&(s+=p.length);let r=n+1;r>=p.length&&(r-=p.length),i.push({node:e[s][yt.UPPER],weight:p[n].difficulty+p[s].difficulty}),i.push({node:e[r][yt.UPPER],weight:p[n].difficulty+p[r].difficulty}),t.set(e[n][yt.UPPER],i)}{const i=[];p[n].ladder&&i.push({node:e[n][yt.UPPER],weight:165+p[n].difficulty});let s=n-3;s<0&&(s+=p.length);let r=n+3;r>=p.length&&(r-=p.length),p[n].wall!==w.LEFT&&p[s].wall!==w.RIGHT&&i.push({node:e[s][yt.LOWER],weight:10}),p[n].wall!==w.RIGHT&&p[r].wall!==w.LEFT&&i.push({node:e[r][yt.LOWER],weight:10}),t.set(e[n][yt.LOWER],i)}}return t}(e);let n=0;for(let i=0;i<p.length;++i){if(p[i].treasure===E.NONE)continue;kt[n]=i;const s=Dt(t,e[i][yt.UPPER]),r=Ht[n++]=new Array(p.length);for(let t=0;t<p.length;++t){r[t]=new Array(2);{const n=s.get(e[t][yt.UPPER]);if(!n)throw new Error("Missing upper distLink");const{link:i}=n;let o=Rt.RIGHT;if(i)if(i.tier===yt.LOWER)o=Rt.DOWN;else{let e=t-1;e<0&&(e+=p.length),o=i.scene===e?Rt.LEFT:Rt.RIGHT}r[t][yt.UPPER]=new Tt(o)}{const n=s.get(e[t][yt.LOWER]);if(!n)throw new Error("Missing lower distLink");const{link:i}=n;let o=Rt.RIGHT;if(i)if(i.tier===yt.UPPER)o=Rt.UP;else{let e=t-3;e<0&&(e+=p.length),o=i.scene===e?Rt.LEFT:Rt.RIGHT}r[t][yt.LOWER]=new Tt(o)}}}}();class _t{constructor(e={}){}update(e){let t,n=0;switch(e.sceneStates[e.harry.scene].treasure){case E.DIAMOND_RING:t=te,n=5e3;break;case E.GOLD_BRICK:t=Z[e.rattle.getValue()],n=4e3;break;case E.SILVER_BRICK:t=z[e.rattle.getValue()],n=3e3;break;case E.MONEY_BAG:t=q,n=2e3;break;default:return}e.harry.intersects(t,108,111)&&(e.sceneStates[e.harry.scene].treasure=E.NONE,e.score+=n,32==++e.treasureCount?e.endGame():Bt(e),f("sfx/treasure.mp3"))}render(e,t,n,i){let s;switch(e.sceneStates[n].treasure){case E.DIAMOND_RING:s=ee;break;case E.GOLD_BRICK:s=j[e.rattle.getValue()];break;case E.SILVER_BRICK:s=J[e.rattle.getValue()];break;case E.MONEY_BAG:s=$;break;default:return}t.drawImage(s,108-i,111)}}class Mt{minutes;seconds;frames;constructor(e={minutes:N.difficulty===S.EASY?22:N.difficulty===S.NORMAL?21:20,seconds:0,frames:59}){this.minutes=e.minutes,this.seconds=e.seconds,this.frames=e.frames}update(e){0!==this.minutes||0!==this.seconds||0!==this.frames?--this.frames>=0||(this.frames=59,--this.seconds>=0||(this.seconds=59,--this.minutes)):e.endGame()}render(e){me(e,this.minutes,29,16,B.OFF_WHITE),e.drawImage(se[B.OFF_WHITE][10],37,16),me(e,this.seconds,53,16,B.OFF_WHITE,2)}}class Ft{enteredLeft=!0;treasure;constructor(e={enteredLeft:!0,treasure:E.NONE}){this.enteredLeft=e.enteredLeft,this.treasure=e.treasure}}class Wt{sceneStates;harry;scorpion;vine;pit;rollingLog;stationaryLog;rattle;cobraAndFire;treasure;clock;scrollX;lastScrollX;ox;lastOx;nextOx;nextScene;lastNextScene;lastHarryUnderground;sceneAlpha;score;extraLives;gameOver;gameOverDelay;newHighScore;scoreColor;treasureCount;treasureMapIndex;constructor(e={sceneStates:void 0,harry:void 0,scorpion:void 0,vine:void 0,pit:void 0,rollingLog:void 0,stationaryLog:void 0,rattle:void 0,cobraAndFire:void 0,treasure:void 0,clock:void 0,scrollX:4,lastScrollX:4,ox:0,lastOx:0,nextOx:0,nextScene:0,lastNextScene:0,lastHarryUnderground:!1,sceneAlpha:1,score:2e3,extraLives:N.difficulty===S.EASY?4:N.difficulty===S.NORMAL?3:2,gameOver:!1,gameOverDelay:180,newHighScore:!1,scoreColor:B.OFF_WHITE,treasureCount:0,treasureMapIndex:0}){if(this.sceneStates=new Array(p.length),e.sceneStates?.length===p.length)for(let t=p.length-1;t>=0;--t)this.sceneStates[t]=new Ft(e.sceneStates[t]);else for(let e=p.length-1;e>=0;--e)this.sceneStates[e]=new Ft({enteredLeft:!0,treasure:p[e].treasure});this.harry=new ct(e.harry),this.scorpion=new gt(e.scorpion),this.vine=new ft(e.vine),this.pit=new It(e.pit),this.rollingLog=new St(e.rollingLog),this.stationaryLog=new Ct(e.stationaryLog),this.rattle=new Nt(e.rattle),this.cobraAndFire=new vt(e.cobraAndFire),this.treasure=new _t(e.treasure),this.clock=new Mt(e.clock),this.scrollX=e.scrollX,this.lastScrollX=e.lastScrollX,this.ox=e.ox,this.lastOx=e.lastOx,this.nextOx=e.nextOx,this.nextScene=e.nextScene,this.lastNextScene=e.lastNextScene,this.lastHarryUnderground=e.lastHarryUnderground,this.sceneAlpha=e.sceneAlpha,this.score=e.score,this.extraLives=e.extraLives,this.gameOver=e.gameOver,this.gameOverDelay=e.gameOverDelay,this.newHighScore=e.newHighScore,this.scoreColor=e.scoreColor,this.treasureCount=e.treasureCount,this.treasureMapIndex=e.treasureMapIndex}endGame(){this.gameOver||(this.gameOver=!0,this.gameOverDelay=32===this.treasureCount?600:180,N.gameState=void 0,this.score>N.highScores[N.difficulty]&&(this.newHighScore=!0,N.highScores[N.difficulty]=this.score))}}const Yt=1/30,Pt=.5,Kt=4,Ut=[[0,32,92,124],[8,40,84,116],[16,48,76,108],[20,52,72,104]];let Xt;function Qt(){N.gameState=Xt=new Wt(N.gameState),Bt(Xt)}function Vt(){if(function(e){let t=!1,n=!1,i=!1,s=!1,r=!1;e.harry.canStartClimbingUp()&&(0!==Qe&&0===e.harry.dir||0!==Xe&&1===e.harry.dir)?i=!0:e.harry.isClimbing()?Xe>Qe?e.harry.rightTouchMeansDown?i=!0:s=!0:Qe>Xe&&(e.harry.rightTouchMeansDown?s=!0:i=!0):Xe>Qe?Qe>0?(n=!0,r=!0):t=!0:Qe>Xe&&(Xe>0?(t=!0,r=!0):n=!0);let o=!1,a=!1,l=!1,c=!1,h=!1;const d=navigator.getGamepads();if(d)for(let e=d.length-1;e>=0;--e){const t=d[e];if(!t)continue;(t.buttons[14]?.pressed||t.buttons[4]?.pressed||t.buttons[10]?.pressed)&&(o=!0),(t.buttons[15]?.pressed||t.buttons[5]?.pressed||t.buttons[11]?.pressed)&&(a=!0),t.buttons[12]?.pressed&&(l=!0),t.buttons[13]?.pressed&&(c=!0);const n=t.axes[0],i=t.axes[2];n<-Ee||i<-Ee?o=!0:(n>Ee||i>Ee)&&(a=!0);const s=t.axes[1],r=t.axes[3];s<-Ee||r<-Ee?l=!0:(s>Ee||r>Ee)&&(c=!0),(t.buttons[0]?.pressed||t.buttons[1]?.pressed||t.buttons[2]?.pressed||t.buttons[3]?.pressed||t.buttons[6]?.pressed||t.buttons[7]?.pressed||t.buttons[8]?.pressed||t.buttons[9]?.pressed)&&(h=!0)}Le=t||o||We>Ye,we=n||a||Ye>We,Re=i||l||Pe>Ke,ye=s||c||Ke>Pe,Ie=r||h||Ue,Se=Le&&!ke,Ge=!Le&&ke,Ce=we&&!He,De=!we&&He,Ne=Re&&!_e,be=!Re&&_e,ve=ye&&!Me,Te=!ye&&Me,xe=Ie&&!Fe,Be=!Ie&&Fe,ke=Le,He=we,_e=Re,Me=ye,Fe=Ie}(Xt),Xt.gameOver)return Xt.newHighScore&&(Xt.scoreColor=Xt.scoreColor+1&255),Xt.gameOverDelay>0?void--Xt.gameOverDelay:void((Ne||ve||Se||Ce||xe)&&Qt());Xt.harry.teleported=!1;const e=Xt.harry.scene,t=Xt.nextScene;Xt.harry.isInjured()||(Xt.clock.update(Xt),Xt.rattle.update(),Xt.cobraAndFire.update(Xt),Xt.treasure.update(Xt),Xt.scorpion.update(Xt),Xt.vine.update(Xt),Xt.pit.update(Xt),Xt.rollingLog.update(Xt),Xt.stationaryLog.update(Xt),Xt.sceneAlpha<1&&(Xt.sceneAlpha+=Yt,Xt.sceneAlpha>1&&(Xt.sceneAlpha=1))),Xt.harry.update(Xt);const n=Xt.harry.isUnderground();var i;Xt.lastHarryUnderground!==n&&(Xt.lastHarryUnderground=n,Xt.lastNextScene=Xt.nextScene,Xt.sceneAlpha=(i=1-Xt.sceneAlpha)<0?0:i>1?1:i);const s=Math.floor(Xt.harry.absoluteX);s<Xt.scrollX-Kt?Xt.lastScrollX===s||Xt.harry.teleported?Xt.scrollX-=Pt:Xt.scrollX-=Math.max(Pt,Xt.lastScrollX-s):s>Xt.scrollX+Kt&&(Xt.lastScrollX===s||Xt.harry.teleported?Xt.scrollX+=Pt:Xt.scrollX+=Math.max(Pt,s-Xt.lastScrollX)),Xt.lastScrollX=s,Xt.ox=Math.floor(Xt.harry.x)-68+Math.floor(Xt.scrollX)-s,Xt.lastOx!==Xt.ox&&(Xt.rollingLog.sync(),Xt.lastOx=Xt.ox),Xt.ox<0?(Xt.nextOx=Xt.ox+b.WIDTH,Xt.nextScene=Xt.harry.scene-(n?3:1),Xt.nextScene<0&&(Xt.nextScene+=p.length),Xt.nextScene!==e&&Xt.nextScene!==t&&(Xt.sceneStates[Xt.nextScene].enteredLeft=!1)):(Xt.nextOx=Xt.ox-b.WIDTH,Xt.nextScene=Xt.harry.scene+(n?3:1),Xt.nextScene>=p.length&&(Xt.nextScene-=p.length),Xt.nextScene!==e&&Xt.nextScene!==t&&(Xt.sceneStates[Xt.nextScene].enteredLeft=!0))}function jt(e,t,n){const{trees:i,ladder:s,holes:r,wall:o,vine:a,pit:l,obsticles:c,scorpion:h}=p[t],d=Ut[i];if(N.difficulty===S.EASY){const i=Ht[Xt.treasureMapIndex][t];e.drawImage(ue[yt.UPPER][i[yt.UPPER].direction],60-n,75);const s=i[yt.LOWER].direction;let r;switch(o){case w.LEFT:r=s===Rt.RIGHT||s===Rt.LEFT?52:53;break;case w.RIGHT:r=68;break;default:r=60}e.drawImage(ue[yt.LOWER][i[yt.LOWER].direction],r-n,150)}e.fillStyle=k[B.DARK_BROWN];for(let t=3;t>=0;--t)e.drawImage(ie,d[t]-2-n,51),e.fillRect(d[t]-n,59,4,52);if(s){e.fillStyle=k[B.BLACK],e.fillRect(60-n,116,8,6),e.fillRect(60-n,127,8,15),e.fillStyle=k[B.DARK_YELLOW];for(let t=10,i=130;t>=0;--t,i+=4)e.fillRect(62-n,i,4,2)}switch(r&&(e.fillStyle=k[B.BLACK],e.fillRect(32-n,116,12,6),e.fillRect(32-n,127,12,15),e.fillRect(84-n,116,12,6),e.fillRect(84-n,127,12,15)),o){case w.LEFT:e.drawImage(ne,2-n,142),e.drawImage(ne,2-n,158);break;case w.RIGHT:e.drawImage(ne,120-n,142),e.drawImage(ne,120-n,158)}switch(h&&Xt.scorpion.render(Xt,e,n),a&&Xt.vine.render(Xt,e,n),l!==m.NONE&&Xt.pit.render(Xt,e,t,n),Xt.sceneStates[t].treasure!==E.NONE&&Xt.treasure.render(Xt,e,t,n),c){case L.ONE_ROLLING_LOG:case L.TWO_ROLLING_LOGS_NEAR:case L.TWO_ROLLING_LOGS_FAR:case L.THREE_ROLLING_LOGS:Xt.rollingLog.render(Xt,e,t,n);break;case L.ONE_STATIONARY_LOG:case L.THREE_STATIONARY_LOGS:Xt.stationaryLog.render(Xt,e,t,n);break;case L.COBRA:case L.FIRE:Xt.cobraAndFire.render(Xt,e,t,n)}}function Zt(e,t,n){const{trees:i}=p[t];e.fillStyle=k[B.DARK_GREEN],e.fillRect(0,0,b.WIDTH,51);for(let t=1;t<5;++t)e.drawImage(K[1&t^1][i],(t-1<<5)-n,51,32,8);e.drawImage(K[0][i],0,0,2,4,128-n,51,8,8)}const Jt=1e3/60,zt=5;let $t=!1,qt=0,en=0,tn=0;function nn(){$t||($t=!0,tn=0,qt=requestAnimationFrame(rn),en=performance.now())}function sn(){$t&&($t=!1,cancelAnimationFrame(qt))}function rn(){if(!$t)return;qt=requestAnimationFrame(rn),Sn();const e=performance.now(),t=e-en;en=e,tn+=t;let n=0;for(;tn>=Jt&&$t;)if(Vt(),tn-=Jt,++n>zt){tn=0,en=performance.now();break}}let on,an,ln,cn,hn,dn,un,gn=null,fn=!1;function On(){!fn&&null===gn&&"wakeLock"in navigator&&(fn=!0,navigator.wakeLock.request("screen").then((e=>{fn&&(gn=e,gn.addEventListener("release",(()=>{fn||(gn=null)})))})).catch((e=>{})).finally((()=>fn=!1)))}let An,pn,mn,En,Ln=null,wn=!1;function Rn(){if(null!==Ln&&(Ln(),Ln=null),wn)return;const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);e.addEventListener("change",Rn),Ln=()=>e.removeEventListener("change",Rn),Cn()}function yn(){wn||(wn=!0,sn(),window.removeEventListener("click",tt),window.removeEventListener("mousemove",qe),window.removeEventListener("mouseenter",qe),window.removeEventListener("mouseleave",$e),$e(),window.removeEventListener("keydown",nt),window.removeEventListener("keyup",it),window.removeEventListener("touchstart",et),window.removeEventListener("touchmove",et),window.removeEventListener("touchend",et),window.removeEventListener("touchcancel",et),ze(),A(),null!==gn&&"wakeLock"in navigator&&(fn=!1,gn.release().then((()=>{fn||(gn=null)})).catch((e=>{}))),window.removeEventListener("beforeunload",vn),window.removeEventListener("resize",Cn),window.removeEventListener("focus",Nn),window.removeEventListener("blur",Nn),document.removeEventListener("visibilitychange",Nn),null!==Ln&&(Ln(),Ln=null),v())}function In(){yn(),Bn()}function Sn(){ln?un&&(ln.imageSmoothingEnabled=!1,ln.fillStyle="#0F0F0F",ln.fillRect(0,0,cn,hn),un.imageSmoothingEnabled=!1,function(e){!function(e){e.fillStyle=k[B.GREEN],e.fillRect(0,51,b.WIDTH,60),e.fillStyle=k[B.LIGHT_YELLOW],e.fillRect(0,111,b.WIDTH,16),e.fillStyle=k[B.DARK_YELLOW],e.fillRect(0,127,b.WIDTH,15),e.fillRect(0,174,b.WIDTH,6),e.fillStyle=k[B.BLACK],e.fillRect(0,142,b.WIDTH,32)}(e),jt(e,Xt.harry.scene,Xt.ox),1===Xt.sceneAlpha?jt(e,Xt.nextScene,Xt.nextOx):(e.globalAlpha=1-Xt.sceneAlpha,jt(e,Xt.lastNextScene,Xt.nextOx),e.globalAlpha=Xt.sceneAlpha,jt(e,Xt.nextScene,Xt.nextOx),e.globalAlpha=1),Xt.harry.render(Xt,e,Xt.ox),Zt(e,Xt.harry.scene,Xt.ox),1===Xt.sceneAlpha?Zt(e,Xt.nextScene,Xt.nextOx):(e.globalAlpha=1-Xt.sceneAlpha,Zt(e,Xt.lastNextScene,Xt.nextOx),e.globalAlpha=Xt.sceneAlpha,Zt(e,Xt.nextScene,Xt.nextOx),e.globalAlpha=1),function(e){me(e,Xt.score,45,3,Xt.scoreColor),Xt.clock.render(e),e.fillStyle=k[B.OFF_WHITE];for(let t=Xt.extraLives-1,n=5;t>=0;--t,n+=2)e.fillRect(n,16,1,8);if(N.difficulty!==S.HARD){me(e,Xt.harry.scene+1,116,3,B.OFF_WHITE),me(e,Xt.treasureCount,92,16,B.OFF_WHITE);const t=se[B.OFF_WHITE];e.drawImage(t[10],100,16),e.drawImage(t[3],108,16),e.drawImage(t[2],116,16)}}(e)}(un),ln.drawImage(dn,mn,En,An,pn),ln.imageSmoothingEnabled=!0,ln.fillStyle="#FFFFFF",ln.fillRect(27,21,18,1),ln.fillRect(27,27,18,1),ln.fillRect(27,33,18,1)):Cn()}function Cn(){if(wn)return;ln=null,an=document.getElementById("main-canvas"),an.style.display="none";const e=window.innerWidth,t=window.innerHeight;an.style.display="block",an.style.width=`${e}px`,an.style.height=`${t}px`,an.style.position="absolute",an.style.left="0px",an.style.top="0px",on=window.devicePixelRatio||1,an.width=Math.floor(on*e),an.height=Math.floor(on*t);const n=new DOMMatrix;e>=t?(cn=e,hn=t,n.a=n.d=on,n.b=n.c=n.e=n.f=0):(cn=t,hn=e,n.a=n.d=n.e=0,n.c=on,n.b=-n.c,n.f=on*t),ln=an.getContext("2d"),ln&&(ln.setTransform(n),pn=hn,An=pn*T.WIDTH/T.HEIGHT,An>cn?(An=cn,pn=An*T.HEIGHT/T.WIDTH,mn=0,En=Math.round((hn-pn)/2)):(mn=Math.round((cn-An)/2),En=0),Sn())}function Nn(){!wn&&"visible"===document.visibilityState&&document.hasFocus()?(On(),ze(),nn()):(sn(),A())}function vn(){yn()}let xn,Gn,Dn=!1;const bn=new Array(3);let Tn;function Bn(){Tn=N.difficulty,document.body.style.backgroundColor="#0F0F0F",window.addEventListener("resize",Fn),window.addEventListener("touchmove",_n,{passive:!1}),document.getElementById("main-content").innerHTML=`\n            <div id="start-container">\n                <div id="start-div">\n                    <div id="high-score-div">High Score: ${N.highScores[Tn]}</div>\n                    <div class="volume-div">\n                        <span class="left-volume-label material-icons" id="left-volume-span" \n                                lang="en">volume_mute</span>\n                        <input type="range" id="volume-input" min="0" max="100" step="any" value="10">\n                        <span class="right-volume-label" id="right-volume-span" lang="en">100</span>\n                    </div>\n                    <div class="difficulty-div">\n                        <div id="dropdown-label">Difficulty:</div>\n                        <div id="custom-dropdown" class="custom-dropdown">\n                            <div class="dropdown-selected">${function(){switch(N.difficulty){case S.EASY:return"Easy";case S.NORMAL:return"Normal";default:return"Hard"}}()}</div>\n                            <div class="dropdown-options">\n                                <div class="dropdown-option" data-value="0">Easy</div>\n                                <div class="dropdown-option" data-value="1">Normal</div>\n                                <div class="dropdown-option" data-value="2">Hard</div>\n                            </div>\n                        </div>    \n                    </div>    \n                    <div id="go-div">${N.gameState?'<button id="start-button">New Game</button><button id="continue-button">Continue</button>':'<button id="start-button">Start</button>'}\n                    </div>\n                </div>\n            </div>`;const e=document.getElementById("high-score-div"),t=document.getElementById("volume-input");t.addEventListener("input",Mn),t.value=String(N.volume),document.getElementById("start-button").addEventListener("click",kn);const n=document.getElementById("continue-button");n?.addEventListener("click",Hn);const i=document.getElementById("custom-dropdown"),s=i.querySelector(".dropdown-selected"),r=i.querySelectorAll(".dropdown-option");xn=()=>i.classList.toggle("open"),s.addEventListener("click",xn),Gn=e=>{i.contains(e.target)||i.classList.remove("open")},document.addEventListener("click",Gn),r.forEach((t=>{const n=Number(t.getAttribute("data-value"));bn[n]=()=>{Tn=n,e.textContent=`High Score: ${N.highScores[Tn]}`,s.textContent=t.textContent,i.classList.remove("open")},t.addEventListener("click",bn[n])})),Fn()}function kn(){N.gameState=void 0,N.difficulty=Tn,Hn()}function Hn(){g(N.volume),function(){window.removeEventListener("resize",Fn),window.removeEventListener("touchmove",_n),document.getElementById("volume-input").removeEventListener("input",Mn),document.getElementById("start-button").removeEventListener("click",kn);const e=document.getElementById("continue-button");e?.removeEventListener("click",Hn);const t=document.getElementById("custom-dropdown");document.removeEventListener("click",Gn),t.querySelector(".dropdown-selected").removeEventListener("click",xn),t.querySelectorAll(".dropdown-option").forEach((e=>e.removeEventListener("click",bn[Number(e.getAttribute("data-value"))]))),v()}(),wn=!1,Qt(),document.body.style.backgroundColor="#C2BCB1",dn=new OffscreenCanvas(b.WIDTH,b.HEIGHT),un=dn.getContext("2d"),document.getElementById("main-content").innerHTML='<canvas id="main-canvas" class="canvas" width="1" height="1"></canvas>',an=document.getElementById("main-canvas"),an.style.touchAction="none",window.addEventListener("beforeunload",vn),window.addEventListener("resize",Cn),window.addEventListener("focus",Nn),window.addEventListener("blur",Nn),document.addEventListener("visibilitychange",Nn),On(),Rn(),window.addEventListener("click",tt),window.addEventListener("mousemove",qe),window.addEventListener("mouseenter",qe),window.addEventListener("mouseleave",$e),qe(),window.addEventListener("touchstart",et,{passive:!1}),window.addEventListener("touchmove",et,{passive:!1}),window.addEventListener("touchend",et,{passive:!1}),window.addEventListener("touchcancel",et,{passive:!1}),window.addEventListener("keydown",nt),window.addEventListener("keyup",it),ze(),nn()}function _n(e){let t=e.target;for(;null!==t;){if("volume-input"===t.id){if(Dn)return;const n=t,i=parseFloat(n.max),s=parseFloat(n.min),r=n.getBoundingClientRect(),o=(1-(e.touches[0].clientY-r.top)/r.height)*(i-s)+s;return n.value=o.toString(),void n.dispatchEvent(new Event("input"))}t=t.parentElement}e.preventDefault()}function Mn(){const e=document.getElementById("left-volume-span"),t=document.getElementById("volume-input"),n=document.getElementById("right-volume-span");N.volume=100*(+t.value-+t.min)/(+t.max-+t.min),t.style.setProperty("--thumb-position",`${N.volume}%`),0===N.volume?e.textContent="volume_off":N.volume<33?e.textContent="volume_mute":N.volume<66?e.textContent="volume_down":e.textContent="volume_up",n.textContent=String(Math.round(N.volume))}function Fn(){const e=document.getElementById("start-container"),t=document.getElementById("start-div"),n=document.getElementById("left-volume-span"),i=document.getElementById("right-volume-span");e.style.width=e.style.height="",e.style.left=e.style.top="",e.style.display="none",t.style.left=t.style.top=t.style.transform="",t.style.display="none";const s=window.innerWidth,r=window.innerHeight;if(Dn=s>=r,e.style.left="0px",e.style.top="0px",e.style.width=`${s}px`,e.style.height=`${r}px`,e.style.display="block",t.style.display="flex",n.style.width="",n.style.display="inline-block",n.style.textAlign="center",n.textContent="🔇",n.style.transform="",i.style.width="",i.style.display="inline-block",i.style.textAlign="center",i.textContent="100",Dn){const e=n.getBoundingClientRect().width;n.style.width=`${e}px`;const o=i.getBoundingClientRect().width;i.style.width=`${o}px`;const a=t.getBoundingClientRect();t.style.left=(s-a.width)/2+"px",t.style.top=(r-a.height)/2+"px"}else{const e=n.getBoundingClientRect().height;n.style.width=`${e}px`;const o=i.getBoundingClientRect().height;i.style.width=`${o}px`,t.style.transform="rotate(-90deg)";const a=t.getBoundingClientRect();t.style.left=(s-a.height)/2+"px",t.style.top=(r-a.width)/2+"px"}i.textContent=String(N.volume),Mn()}let Wn,Yn=!1;function Pn(e){if(Wn){if(e===Wn.style.color)return;Wn.style.color=e}const t="progress-bar-style";let n=document.getElementById(t);n||(n=document.createElement("style"),n.id=t,document.head.appendChild(n)),n.innerText=`\n        #loading-progress::-webkit-progress-value {\n            background-color: ${e} !important;\n        }\n        #loading-progress::-moz-progress-bar {\n            background-color: ${e} !important;\n        }\n    `}function Kn(e){Wn&&(Wn.value=100*e.data,Pn("#48D800"))}function Un(e){n.e(96).then(n.t.bind(n,710,23)).then((({default:t})=>{(new t).loadAsync(e).then((e=>Object.entries(e.files).forEach((e=>{const[t,n]=e;var i,r;n.dir||t.endsWith(".mp3")&&(i=t,r=n,h.push(r.async("arraybuffer").then((e=>s.decodeAudioData(e))).then((e=>d.set(i,e)))))}))))})),async function(){return Promise.all(h).then((()=>h.length=0))}().then((()=>{document.getElementById("loading-progress").value=100,setTimeout((()=>{!function(){if(N)return;const e=localStorage.getItem(I);if(e)try{N=JSON.parse(e),N.gameState=N.gameState&&!N.gameState.gameOver?new Wt(N.gameState):void 0}catch{N=new C}else N=new C}(),async function(){let e;!function(e){e[e.CLIMBCOLTAB=0]="CLIMBCOLTAB",e[e.RUNCOLTAB=22]="RUNCOLTAB",e[e.LOGCOLOR=43]="LOGCOLOR",e[e.FIRECOLOR=59]="FIRECOLOR",e[e.COBRACOLOR=75]="COBRACOLOR",e[e.CROCOCOLOR=91]="CROCOCOLOR",e[e.MONEYBAGCOLOR=107]="MONEYBAGCOLOR",e[e.SCORPIONCOLOR=123]="SCORPIONCOLOR",e[e.WALLCOLOR=139]="WALLCOLOR",e[e.RINGCOLOR=155]="RINGCOLOR",e[e.GOLDBARCOLOR=171]="GOLDBARCOLOR",e[e.SILVERBARCOLOR=187]="SILVERBARCOLOR",e[e.LEAVESCOLOR=203]="LEAVESCOLOR",e[e.BRANCHESCOLOR=207]="BRANCHESCOLOR",e[e.LEAVES0=215]="LEAVES0",e[e.LEAVES1=219]="LEAVES1",e[e.LEAVES2=223]="LEAVES2",e[e.LEAVES3=227]="LEAVES3",e[e.HARRY0=231]="HARRY0",e[e.HARRY1=253]="HARRY1",e[e.HARRY2=275]="HARRY2",e[e.HARRY3=297]="HARRY3",e[e.HARRY4=319]="HARRY4",e[e.HARRY5=341]="HARRY5",e[e.HARRY6=363]="HARRY6",e[e.HARRY7=385]="HARRY7",e[e.BRANCHES=407]="BRANCHES",e[e.PIT=415]="PIT",e[e.LOG0=420]="LOG0",e[e.FIRE0=436]="FIRE0",e[e.COBRA0=452]="COBRA0",e[e.COBRA1=468]="COBRA1",e[e.CROCO0=484]="CROCO0",e[e.CROCO1=500]="CROCO1",e[e.MONEYBAG=516]="MONEYBAG",e[e.SCORPION0=532]="SCORPION0",e[e.SCORPION1=548]="SCORPION1",e[e.WALL=564]="WALL",e[e.BAR0=580]="BAR0",e[e.BAR1=596]="BAR1",e[e.RING=612]="RING",e[e.ZERO=628]="ZERO",e[e.ONE=636]="ONE",e[e.TWO=644]="TWO",e[e.THREE=652]="THREE",e[e.FOUR=660]="FOUR",e[e.SIX=676]="SIX",e[e.SEVEN=684]="SEVEN",e[e.EIGHT=692]="EIGHT",e[e.NINE=700]="NINE",e[e.COLON=708]="COLON",e[e.ARROWRIGHT=716]="ARROWRIGHT",e[e.ARROWLEFT=732]="ARROWLEFT",e[e.ARROWUP=748]="ARROWUP",e[e.ARROWDOWN=764]="ARROWDOWN"}(e||(e={}));const t=function(){const e=new Array(256),t=atob("AAAAPz8+ZGRjhISDoqKhurq50tLR6urpPT0AXl4Ke3sVmZkgtLQqzc005uY+/f1IcSMAhj0LmVcYrW8mvYYyzZs+3LBJ6sJUhhUAmi8OrkgewGEv0Xc+4I1N76Jb/bVoigAAnhMSsSgnwj080lFQ4mRj73V0/YaFeQBYjRJuoCeEsTuYwE6q0GG83XHM6oLcRQB4XRKPciekiDu5m07KrmHcv3Hs0IL7DgCFKROZQyitXT2/dFHQi2TfoXXutYb7AACKEhOdJCiwNz3BSVHRWmTganXueYb7ABV9EjGTJEynN2e7SYDMWpfdaq7tecL7ACdYEkV0JGKNN36nSZe+WrDUasfoed37ADUmEldCJHZdN5V2SbGOWsylauW7ef3PADkAE1sSKHknPZc8UbNQZM1jdeZ0hv2FDjIAK1QRR3MjY5M2fbBIlctZreVpwv14Jy4ARU4PYmshfogzl6NDsLxTx9Ri3epwPSMAXkINe18dmXsttJY7za9K5sdX/d1k");for(let n=0;n<=255;++n){const i=3*(n>>1),s=new D(t.charCodeAt(i),t.charCodeAt(i+1),t.charCodeAt(i+2));e[n]=s,k[n]=`#${(s.r<<16|s.g<<8|s.b).toString(16).padStart(6,"0")}`}return e}(),n=atob("0tLS0tLS0tLS0tLSyMjIyMjISkpKEtLS0tLS0tLS0tLIyMjIyMjISkpKEhISEhISEhISEhISEhISEhIQEBAQED4+Pi4uLi4uLi4uAAAEAAQAAAAAAAAAAABCQtDQ0NDQ0NDQ0NDQ0NDQ0NAEBAQEBAQEBAQEBAQSBAQEDg4ODg4ODg4ODg4ODg4ODgZCQkIGQkJCBkJCQgZCQkJCQh4eHh4eHh4eDg4ODg4OHh4eHh4eHh4ODg4ODg4ODgYGBgYGBgYODg4ODg4ODg7S0tLSEBAQEBAQEBABg8//ABg9fxi8/v8wePz+AAAAAAAzctoeHBhYWHw+GhgQGBgYAACAgMNiYjY+HBgYPD46OBgYEBgYGAAQICIkNDIWHhwYGBwcGBgYGBAYGBgADAgoKD4KDhwYGBwcGBgYGBgQGBgYAAACQ0R0FBwcGBgYPD46OBgYEBgYGAAYEBwYGBgYGBgYGBgcHhoYGBAYGBgAAAAAAAAAY/L23MDAwMDA8NCQ0NDAADAQEBAWFBQWEhYeHBg4ODweGgIYGBh+25mZmZmZmQABAw9/ABgkWlpaZn5edn5edjwYAADD5348GDx8fHg4ODAwEBAA/vn5+flgEAgMDAg4MEAAAP75+fr6YBAIDAwIODCAAAAAAAAA/6sDAwsuuuCAAAAAAAAAAP+rVf8GBAAAAAAAAD53d2N7Y29jNjYcCBw2AIUyPXj4xoKQiNhwAAAAAABJMzx4+sSSiNhwAAAAAAAA/rq6uv7u7u7+urq6/u7u7gD4/P7+fj4AEABUAJIAEAAA+Pz+/n4+AAAoAFQAEAAAAAA4bERERGw4EDh8OAAAADxmZmZmZmY8PBgYGBgYOBh+YGA8BgZGPDxGBgwMBkY8DAwMfkwsHAx8RgYGfGBgfjxmZmZ8YGI8GBgYGAwGQn48ZmY8PGZmPDxGBj5mZmY8ABgYAAAYGAAACAgMDP7+///+/gwMCAgAABAQMDB/f///f38wMBAQABAQODh8fP7+ODg4ODg4ODg4ODg4ODg4OP7+fHw4OBAQ"),i=[];for(let s=0;s<2;++s){const r=1===s;K[s]=new Array(4);for(let o=0;o<4;++o)Oe(n,t,e.LEAVES0+4*o,e.LEAVESCOLOR,4,r,(e=>K[s][o]=e),null,i);H[s]=new Array(8),_[s]=new Array(8);for(let o=0;o<8;++o){const a=o<=5?5-o:o;Oe(n,t,e.HARRY0+22*o,7===o?e.CLIMBCOLTAB:e.RUNCOLTAB,22,r,(e=>H[s][a]=e),(e=>_[s][a]=e),i)}M[s]=new Array(2),F[s]=new Array(2),Oe(n,t,e.COBRA1,e.COBRACOLOR,16,r,(e=>M[s][0]=e),(e=>F[s][0]=e),i),Oe(n,t,e.COBRA0,e.COBRACOLOR,16,r,(e=>M[s][1]=e),(e=>F[s][1]=e),i),W[s]=new Array(2),Oe(n,t,e.CROCO1,e.CROCOCOLOR,16,r,(e=>W[s][0]=e),null,i),Oe(n,t,e.CROCO0,e.CROCOCOLOR,16,r,(e=>W[s][1]=e),null,i),Y[s]=new Array(2),P[s]=new Array(2),Oe(n,t,e.SCORPION1,e.SCORPIONCOLOR,16,r,(e=>Y[s][0]=e),(e=>P[s][0]=e),i),Oe(n,t,e.SCORPION0,e.SCORPIONCOLOR,16,r,(e=>Y[s][1]=e),(e=>P[s][1]=e),i)}Oe(n,t,e.LOG0,e.LOGCOLOR,16,!0,(e=>U[0]=e),(e=>X[0]=e),i),Oe(n,t,e.LOG0,e.LOGCOLOR,16,!1,(e=>U[1]=e),(e=>X[1]=e),i),Oe(n,t,e.FIRE0,e.FIRECOLOR,16,!0,(e=>Q[0]=e),(e=>V[0]=e),i),Oe(n,t,e.FIRE0,e.FIRECOLOR,16,!1,(e=>Q[1]=e),(e=>V[1]=e),i),Oe(n,t,e.BAR1,e.GOLDBARCOLOR,16,!1,(e=>j[0]=e),(e=>Z[0]=e),i),Oe(n,t,e.BAR0,e.GOLDBARCOLOR,16,!1,(e=>j[1]=e),(e=>Z[1]=e),i),Oe(n,t,e.BAR1,e.SILVERBARCOLOR,16,!1,(e=>J[0]=e),(e=>z[0]=e),i),Oe(n,t,e.BAR0,e.SILVERBARCOLOR,16,!1,(e=>J[1]=e),(e=>z[1]=e),i),Oe(n,t,e.MONEYBAG,e.MONEYBAGCOLOR,16,!1,(e=>$=e),(e=>q=e),i),Oe(n,t,e.RING,e.RINGCOLOR,16,!1,(e=>ee=e),(e=>te=e),i),Oe(n,t,e.WALL,e.WALLCOLOR,16,!1,(e=>ne=e),null,i),Oe(n,t,e.BRANCHES,e.BRANCHESCOLOR,8,!1,(e=>ie=e),null,i);for(let s=0;s<256;++s){const r=t[s];se[s]=new Array(11);for(let t=0;t<11;++t)i.push(ge(8,8,(i=>{const s=e.ZERO+8*(t+1)-1;for(let e=0;e<8;++e){const t=n.charCodeAt(s-e);for(let n=0,s=128;n<8;++n,s>>=1)t&s&&Ae(i,n,e,r)}})).then((({imageBitmap:e})=>se[s][t]=e)))}const s=[B.BLACK,B.BLUE,B.MID_YELLOW];for(let r=0;r<s.length;++r){const o=t[s[r]];re[r]=new Array(2);for(let t=0;t<2;++t)i.push(ge(64,5,(i=>{for(let s=0;s<5;++s){const r=0===t?4-s:s,a=n.charCodeAt(e.PIT+s);for(let e=0,t=128,n=0;e<8;++e,t>>=1,n+=4)if(!(a&t))for(let e=0;e<4;++e){const t=n+e;Ae(i,31-t,r,o),Ae(i,32+t,r,o)}}})).then((({imageBitmap:e})=>re[r][t]=e)))}!function(e,t){const n=245/145,i=Math.atan(1/n);let s=ae,r=le,o=ae,a=le;for(let e=0;e<oe;++e){const t=x*e/oe,l=i*Math.sin(t),c=new G(Math.round(ae+73*n*Math.sin(l)/2),Math.round(le+73*Math.cos(l)),-73*i*x*Math.sin(l)*Math.cos(t)/oe);ce[e]=c,s=Math.min(s,c.x),r=Math.min(r,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}const l=e[B.DARK_BROWN],c=new ImageData(o-s+1,a-r+1);for(let e=0;e<ce.length;++e){const n=ce[e];c.data.fill(0),pe(c,ae-s,le-r,n.x-s,n.y-r,l),de[e]=fe(c),t.push(createImageBitmap(c).then((t=>he[e]=t)))}}(t,i);const r=[B.OFF_GREEN,B.OFF_BLACK];for(let s=0;s<r.length;++s){const o=t[r[s]];ue[s]=new Array(4);for(let t=0;t<4;++t)i.push(ge(8,16,(i=>{const s=e.ARROWRIGHT+16*t;for(let e=0;e<16;++e){const t=n.charCodeAt(s+e);for(let n=0,s=128;n<8;++n,s>>=1)t&s&&Ae(i,n,e,o)}})).then((({imageBitmap:e})=>ue[s][t]=e)))}await Promise.all(i)}().then((()=>{window.removeEventListener("resize",Qn),window.removeEventListener("touchmove",Xn),"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("message",Kn),Bn()}))}),10)}))}function Xn(e){e.preventDefault()}function Qn(){const e=document.getElementById("progress-container"),t=document.getElementById("progress-div");e.style.width=e.style.height="",e.style.left=e.style.top="",e.style.display="none",t.style.top=t.style.left=t.style.transform="",t.style.display="none";const n=window.innerWidth,i=window.innerHeight;if(Yn=n>=i,e.style.left="0px",e.style.top="0px",e.style.width=`${n}px`,e.style.height=`${i}px`,e.style.display="block",t.style.display="flex",Yn){const e=t.getBoundingClientRect();t.style.left=(n-e.width)/2+"px",t.style.top=(i-e.height)/2+"px"}else{t.style.transform="rotate(-90deg)";const e=t.getBoundingClientRect();t.style.left=(n-e.height)/2+"px",t.style.top=(i-e.width)/2+"px"}}let Vn=!1;function jn(e){e.preventDefault()}function Zn(){const e=document.getElementById("death-div");e.style.top=e.style.left=e.style.transform="",e.style.display="none";const t=window.innerWidth,n=window.innerHeight;if(Vn=t>=n,e.style.display="flex",Vn){const i=e.getBoundingClientRect();e.style.left=(t-i.width)/2+"px",e.style.top=(n-i.height)/2+"px"}else{e.style.transform="rotate(-90deg)";const i=e.getBoundingClientRect();e.style.left=(t-i.height)/2+"px",e.style.top=(n-i.width)/2+"px"}}function Jn(){window.addEventListener("error",(e=>{console.error(`Caught in global handler: ${e.message}`,{source:e.filename,lineno:e.lineno,colno:e.colno,error:e.error}),e.preventDefault(),window.addEventListener("resize",Zn),window.addEventListener("touchmove",jn,{passive:!1}),document.getElementById("main-content").innerHTML='<div id="death-div"><span id="fatal-error">&#x1F480;</span></div>',Zn()})),window.addEventListener("unhandledrejection",(e=>e.preventDefault())),document.addEventListener("dblclick",(e=>e.preventDefault()),{passive:!1}),window.addEventListener("resize",Qn),window.addEventListener("touchmove",Xn,{passive:!1}),document.getElementById("main-content").innerHTML='\n            <div id="progress-container">\n                <div id="progress-div">\n                    <progress id="loading-progress" value="0" max="100"></progress>\n                </div>\n            </div>',Wn=document.getElementById("loading-progress"),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",Kn),Qn(),async function(){for(let t=i-1;t>=0;--t)try{const t=await fetch("resources.zip");if(!t.ok)continue;const n=t.headers.get("Content-Length");if(!n)continue;const i=parseInt(n);if(isNaN(i)||i<=0)continue;const s=t.body;if(null===s)continue;const r=s.getReader(),o=[];let a=0;for(;;){const{done:t,value:n}=await r.read();if(t)break;o.push(n),a+=n.length,e=a/i,Wn.value=100*e,Pn("#0075FF")}const l=new Uint8Array(a);let c=0;return o.forEach((e=>{l.set(e,c),c+=e.length})),l}catch(e){if(0===t)throw e}var e;throw new Error("Failed to fetch.")}().then(Un)}}}]);