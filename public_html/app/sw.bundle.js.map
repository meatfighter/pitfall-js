{"version":3,"file":"sw.bundle.js","mappings":"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","sources":["webpack://pitfall-js/webpack/bootstrap","webpack://pitfall-js/webpack/runtime/define property getters","webpack://pitfall-js/webpack/runtime/hasOwnProperty shorthand","webpack://pitfall-js/webpack/runtime/make namespace object","webpack://pitfall-js/./src/sw.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","declare const self: ServiceWorkerGlobalScope;\n\nexport const CACHE_NAME = 'pitfall-cache';\n\nconst MAX_FETCH_RETRIES = 5;\n\nasync function fetchWithRetry(request: Request, options: RequestInit = {}) {\n\n    for (let i = MAX_FETCH_RETRIES - 1; i >= 0; --i) {\n        try {\n            const response = await fetch(request, options);\n            if (!response.ok) {\n                continue;\n            }\n\n            const contentLengthStr = response.headers.get('Content-Length');\n            const contentLength = contentLengthStr ? parseInt(contentLengthStr, 10) : 0;\n            const postStatus = contentLength > 0 && request.url.includes('resources.zip');\n\n            const body = response.body;\n            if (body === null) {\n                continue;\n            }\n\n            const reader = body.getReader();\n            const chunks = [];\n            let bytesReceived = 0;\n            while (true) {\n                const { done, value: chunk } = await reader.read();\n                if (done) {\n                    break;\n                }\n                chunks.push(chunk);\n                bytesReceived += chunk.length;\n                if (postStatus) {\n                    self.clients.matchAll().then(clients => {\n                        clients.forEach(client => {\n                            client.postMessage(bytesReceived / contentLength);\n                        });\n                    });\n                }\n            }\n\n            const uint8Array = new Uint8Array(bytesReceived);\n            let position = 0;\n            chunks.forEach(chunk => {\n                uint8Array.set(chunk, position);\n                position += chunk.length;\n            });\n\n            return new Response(uint8Array, {\n                status: 200,\n                statusText: 'OK',\n                headers: response.headers\n            });\n        } catch (error) {\n            if (i === 0) {\n                throw error;\n            }\n        }\n    }\n    throw new Error(\"Failed to fetch.\");\n}\n\nself.addEventListener('activate', e => {\n    e.waitUntil(\n        caches.keys().then(cacheNames => {\n            return Promise.all(cacheNames.filter(cacheName => cacheName !== CACHE_NAME)\n                .map(cacheName => caches.delete(cacheName)));\n        }).then(() => self.clients.claim())\n    );\n});\n\nself.addEventListener('fetch', e => {\n\n    if (!e.request.url.startsWith('http')) {\n        return;\n    }\n\n    e.respondWith(\n        caches.open(CACHE_NAME).then(cache => {\n            return cache.match(e.request).then(cachedResponse => {\n                if (cachedResponse) {\n                    return cachedResponse;\n                }\n                const fetchOptions: RequestInit = (new URL(e.request.url).hostname !== self.location.hostname)\n                        ? { mode: 'cors', credentials: 'omit' } : {};\n                return fetchWithRetry(e.request, fetchOptions).then(fetchResponse => {\n                    cache.put(e.request, fetchResponse.clone()).then(_ => {});\n                    return fetchResponse;\n                });\n            });\n        }).catch(() => new Response('Service Unavailable', { status: 503 }))\n    );\n});\n\n\n\n"],"names":[],"sourceRoot":""}